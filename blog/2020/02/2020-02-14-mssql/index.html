<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.15.0"/><style data-href="/styles.9e907bc32054b7771552.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style data-styled="" data-styled-version="6.1.19">.jqslCl{display:flex;flex:1;position:relative;margin:0 auto;align-items:start;width:1024px;max-width:1024px;}/*!sc*/
@media (max-width:1024px){.jqslCl{margin:0;width:auto;}}/*!sc*/
data-styled.g1[id="PostContent__PostWrapper-sc-9jovib-0"]{content:"jqslCl,"}/*!sc*/
.kbLKJZ{border-bottom:1px solid #e6e6e6;}/*!sc*/
.kbLKJZ>div{display:flex;flex:1;align-items:center;justify-content:space-between;margin:0 auto;max-width:1024px;padding:0 20px;}/*!sc*/
@media (max-width:1024px){.kbLKJZ>div{margin:0;min-width:auto;}}/*!sc*/
.kbLKJZ h1{font-size:24px;margin:12px 0 8px;}/*!sc*/
data-styled.g2[id="PostContent__PostHeadWrapper-sc-9jovib-1"]{content:"kbLKJZ,"}/*!sc*/
.grIokF{width:80%;}/*!sc*/
@media (max-width:1024px){.grIokF{width:100%;}}/*!sc*/
data-styled.g3[id="PostContent__PostContentWrapper-sc-9jovib-2"]{content:"grIokF,"}/*!sc*/
.eqZssB{padding:0 20px;margin-bottom:48px;}/*!sc*/
.eqZssB>h1{margin-bottom:8px;font-size:40px;}/*!sc*/
data-styled.g4[id="PostContent__PostTitle-sc-9jovib-3"]{content:"eqZssB,"}/*!sc*/
.bnGTbM{display:inline-block;margin:12px 0 0 10px;position:sticky;top:20px;left:100%;transition:all 0.125s esse-in 0s;color:rgba(0,0,0,0.4);padding:0.25rem 0.75rem;border-left:2px solid gray;overflow:hidden auto;max-height:calc(-128px + 100vh);}/*!sc*/
.bnGTbM ul{list-style:none;}/*!sc*/
.bnGTbM ul li{margin-top:5px;}/*!sc*/
.bnGTbM ul li a{display:inline-block;}/*!sc*/
.bnGTbM ul li a.reach{color:#000000;}/*!sc*/
.bnGTbM ul ul{margin-left:12px;}/*!sc*/
@media (max-width:1024px){.bnGTbM{display:none;}}/*!sc*/
data-styled.g5[id="PostContent__TocRenderer-sc-9jovib-4"]{content:"bnGTbM,"}/*!sc*/
.espYpB{display:flex;flex-direction:column;word-break:keep-all;margin-bottom:250px;padding:0 20px;width:100%;line-height:1.8;font-size:16px;font-weight:400;}/*!sc*/
@media (max-width:1024px){.espYpB{margin-bottom:48px;}}/*!sc*/
.espYpB p{padding:3px 0;}/*!sc*/
.espYpB h1,.espYpB h2,.espYpB h3{font-weight:800;}/*!sc*/
.espYpB *+h1{margin-top:60px;}/*!sc*/
.espYpB *+h2{margin-top:40px;}/*!sc*/
.espYpB *+h3{margin-top:30px;}/*!sc*/
.espYpB hr+h1,.espYpB hr+h2,.espYpB hr+h3{margin-top:0;}/*!sc*/
.espYpB h1{font-size:30px;}/*!sc*/
.espYpB h2{font-size:25px;}/*!sc*/
.espYpB h3{font-size:20px;}/*!sc*/
.espYpB blockquote{margin:30px 0;padding:5px 15px;border-left:2px solid #000000;font-weight:800;}/*!sc*/
.espYpB ol,.espYpB ul{margin-left:20px;padding:10px 0;}/*!sc*/
.espYpB hr{border:1px solid #000000;margin:100px 0;}/*!sc*/
.espYpB a{color:#4263eb;text-decoration:underline;}/*!sc*/
.espYpB pre[class*='language-']{margin:30px 0;padding:15px;font-size:15px;}/*!sc*/
.espYpB pre[class*='language-'] ::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.5);border-radius:3px;}/*!sc*/
.espYpB code[class*='language-'],.espYpB pre[class*='language-']{tab-size:2;}/*!sc*/
.espYpB img{width:100%;}/*!sc*/
.espYpB summary{cursor:pointer;font-size:24px;}/*!sc*/
data-styled.g6[id="PostContent__MarkdownRenderer-sc-9jovib-5"]{content:"espYpB,"}/*!sc*/
.epVIUP{margin:40px 0;display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0 20px;}/*!sc*/
.epVIUP h5{font-size:24px;margin-bottom:8px;}/*!sc*/
.epVIUP a{border-radius:6px;font-size:20px;color:#cc007a;font-weight:700;}/*!sc*/
data-styled.g7[id="PostContent__PostNavigator-sc-9jovib-6"]{content:"epVIUP,"}/*!sc*/
.ebAxSj{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.7);color:#161b21;width:40px;height:40px;min-width:40px;font-size:20px;border:none;border-radius:50%;}/*!sc*/
.ebAxSj>img{width:35px;height:35px;}/*!sc*/
data-styled.g8[id="PostContent__SocialLink-sc-9jovib-7"]{content:"ebAxSj,"}/*!sc*/
.cAuPRp{display:grid;place-items:center;margin-top:auto;margin-left:0;padding:50px 0;font-size:15px;text-align:center;line-height:1.5;}/*!sc*/
@media (max-width:1024px){.cAuPRp{margin-left:0;}}/*!sc*/
data-styled.g16[id="Footer__FooterWrapper-sc-rphy7j-0"]{content:"cAuPRp,"}/*!sc*/
html{line-height:1.15;-webkit-text-size-adjust:100%;}/*!sc*/
body{margin:0;}/*!sc*/
main{display:block;}/*!sc*/
h1{font-size:2em;margin:0.67em 0;}/*!sc*/
hr{box-sizing:content-box;height:0;overflow:visible;}/*!sc*/
pre{font-family:monospace,monospace;font-size:1em;}/*!sc*/
a{background-color:transparent;}/*!sc*/
abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted;}/*!sc*/
b,strong{font-weight:bolder;}/*!sc*/
code,kbd,samp{font-family:monospace,monospace;font-size:1em;}/*!sc*/
small{font-size:80%;}/*!sc*/
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}/*!sc*/
sub{bottom:-0.25em;}/*!sc*/
sup{top:-0.5em;}/*!sc*/
img{border-style:none;}/*!sc*/
button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}/*!sc*/
button,input{overflow:visible;}/*!sc*/
button,select{text-transform:none;}/*!sc*/
button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button;}/*!sc*/
button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}/*!sc*/
button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}/*!sc*/
fieldset{padding:0.35em 0.75em 0.625em;}/*!sc*/
legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}/*!sc*/
progress{vertical-align:baseline;}/*!sc*/
textarea{overflow:auto;}/*!sc*/
[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}/*!sc*/
[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}/*!sc*/
[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}/*!sc*/
[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}/*!sc*/
::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}/*!sc*/
details{display:block;}/*!sc*/
summary{display:list-item;}/*!sc*/
template{display:none;}/*!sc*/
[hidden]{display:none;}/*!sc*/
*{padding:0;margin:0;box-sizing:border-box;}/*!sc*/
html,body,#___gatsby{height:100%;word-break:keep-all;overflow-wrap:break-word;}/*!sc*/
#gatsby-focus-wrapper{height:100%;}/*!sc*/
a,a:hover{color:inherit;text-decoration:none;cursor:pointer;}/*!sc*/
.utterances{max-width:1024px;margin:0 auto;}/*!sc*/
data-styled.g18[id="sc-global-dhQtTb1"]{content:"sc-global-dhQtTb1,"}/*!sc*/
.fSFSKX{display:flex;flex-direction:column;height:100%;}/*!sc*/
data-styled.g19[id="Template__Container-sc-1a9t0ug-0"]{content:"fSFSKX,"}/*!sc*/
</style><style type="text/css">
    .custom-class.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .custom-class.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .custom-class svg,
    h2 .custom-class svg,
    h3 .custom-class svg,
    h4 .custom-class svg,
    h5 .custom-class svg,
    h6 .custom-class svg {
      visibility: hidden;
    }
    h1:hover .custom-class svg,
    h2:hover .custom-class svg,
    h3:hover .custom-class svg,
    h4:hover .custom-class svg,
    h5:hover .custom-class svg,
    h6:hover .custom-class svg,
    h1 .custom-class:focus svg,
    h2 .custom-class:focus svg,
    h3 .custom-class:focus svg,
    h4 .custom-class:focus svg,
    h5 .custom-class:focus svg,
    h6 .custom-class:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://seungahhong.github.io/blog/2020/02/2020-02-14-mssql/" data-baseprotocol="https:" data-basehost="seungahhong.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-TYGQRJE1B8', 'auto', {});
      
      
      
      
      
      }</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-G8Z1HZWWYL"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-G8Z1HZWWYL', {"send_page_view":false});
      }
      </script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Template__Container-sc-1a9t0ug-0 fSFSKX"><header class="PostContent__PostHeadWrapper-sc-9jovib-1 kbLKJZ"><div><a href="/"><h1>홍승아블로그</h1></a><a href="https://github.com/seungahhong" rel="noopener noreferrer" title="notion" target="_blank" size="35" class="PostContent__SocialLink-sc-9jovib-7 ebAxSj"><img src="/static/4a6687a74051de2b3536e95d0b6c992a/github.svg" alt="Github Link Image"/></a></div></header><div class="PostContent__PostWrapper-sc-9jovib-0 jqslCl"><div class="PostContent__PostContentWrapper-sc-9jovib-2 grIokF"><div class="PostContent__PostTitle-sc-9jovib-3 eqZssB"><h1>MSSQL</h1><time>2020.02.14</time></div><article class="PostContent__MarkdownRenderer-sc-9jovib-5 espYpB"><h1 id="용어정리" style="position:relative;"><a href="#%EC%9A%A9%EC%96%B4%EC%A0%95%EB%A6%AC" aria-label="용어정리 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>용어정리</h1>
<ul>
<li>
<p>트랜잭션 : 여러 데이터 변경에 대해 하나의 논리적 작업 단위로 취급하여 전체가 완료되거나 롤백되어 데이터의 무결성을 유지</p>
</li>
<li>
<p>COMMIT : 모든 트랜잭션 수정이 영구적으로 데이터베이스 일부로 적용, 트랜잭션에 의해 사용된 리소스 해제</p>
</li>
<li>
<p>ROLLBACK : 시작 상태로 되돌려서 트랜잭션 중 만드러진 모든 수정 내용을 취소</p>
</li>
<li>
<p>트리거 : 특정 테이블에 자료가 수정될 때 내부적으로 관련된 다른 테이블 또는 컬럼에 자동으로 연동하여 갱신하거나 무결성 유지</p>
</li>
<li>
<p>커서 : 메모리상에서 SQL문이 실행되는 위치
메모리에 존재하는 SQL문 실행결과를 바로 접근하여 fetch 가능(SELECT * FROM A)
현재 처리하고 있는 row</p>
</li>
</ul>
<h1 id="sql-server-개요" style="position:relative;"><a href="#sql-server-%EA%B0%9C%EC%9A%94" aria-label="sql server 개요 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SQL Server 개요</h1>
<ul>
<li>
<p>데이터베이스 : 사용자에게 필요한 데이터와 정보를 효율적으로 저장 관리하고 통합적으로 조직하고 관리 할 수 있도록 구성된 데이터</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                  집합체</code></pre></div>
</li>
<li>
<p>관계형 데이터베이스</p>
</li>
</ul>
<ul>
<li>
<p>연관된 데이터가 하나의 테이블에 모두 들어 있는 것이 아니라 여러 개의 서로 다른 테이블로 관리하고 데이터 사이에 어떠한 관계를</p>
<p>부여함으로 데이터를 조직화하는 데이터베이스</p>
</li>
</ul>
<ul>
<li>
<p>SQL Server 서비스</p>
<ul>
<li>데이터베이스 엔진으로서 Transact-SQL 문을 처리하고, 서버 상의 데이터베이스를 구성하는 모든 파일을 관리한다.</li>
</ul>
</li>
<li>
<p>SQL Sever Agent</p>
<ul>
<li>
<p>자동화 관리와 관련된 서비스로 작업,경고,오퍼레이터 등을 생성하여 관리를 자동화한다.</p>
</li>
<li>
<p>예를들면, 로그가 90% 이상이면 경고를 발생시키고 경고가 발생하면 데이터베이스 로그를 백업한다.</p>
</li>
</ul>
</li>
<li>
<p>MS DTC(Microsoft Distributd Transaction Coordinator)</p>
<ul>
<li>분산된 데이터를 하나의 트랜잭션으로 처리하기 위해서 일련의 작업</li>
</ul>
</li>
<li>
<p>전체 텍스트 검색(Full-Text Search)</p>
<ul>
<li>
<p>마이크로소프트 검색 서비스로 텍스트와 문자열에 대한 조회를 다양한 조건으로 쿼리를 수행</p>
</li>
<li>
<p>기능을 사용하기 위해서는 전체 텍스트 인덱스를 만들고 유지보수 해야한다.</p>
</li>
</ul>
</li>
<li>
<p>분석서버</p>
<ul>
<li>
<p>Microsoft SQL Server 2000 Analysis Services의 서버 구성 요소로서 데이터웨어하우스 및 데이터마트에 대한 신속한 분석 액세스를</p>
<p>제공</p>
</li>
</ul>
</li>
<li>
<p>데이터베이스 개체</p>
</li>
</ul>
<ol>
<li>
<p>인덱스 : 데이터 검색에 빠른 처리를 할 수 있게 하거나 데이터 무결성을 강화하기 위해서 사용되는 개체</p>
<p>데이터무결성 : 데이터의 정확성과 일관성을 유지하고 보증하는 것</p>
</li>
<li>
<p>뷰 : 자주 사용되는 쿼리나 복잡한 쿼리를 재사용하기 위해 정의해 놓은 가상 테이블</p>
</li>
<li>
<p>트리거 : 데이트가 변경될 때 자동적으로 실행되는 특별한 형태의 저장 프로시저</p>
</li>
<li>
<p>룰 : CHECK 제약 조건과 같은 역할을 수행하며, 테이블의 컬럼이나 사용자 정의 데이터형과 바인딩하여 사용된다.</p>
<p>EXEC sp_bindrule ‘ZipCode_rule’, ‘ZipCode’</p>
</li>
</ol>
<ul>
<li>시스템 데이터베이스 목적</li>
</ul>
<ol>
<li>
<p>Master : 서버와 관련된 모든 자료를 저장한다.</p>
</li>
<li>
<p>TempDB : 임시테이블을 만들거나 ORDER BY, DISTINCT 등의 구문을 동반시 임시 작업 공간으로 사용</p>
</li>
<li>
<p>Model : 새로운 데이터베이스 생성시 모델이 되는 데이터베이스</p>
</li>
<li>
<p>MSDB : 자동화 관리와 관련된 내용을 기록한다.</p>
</li>
<li>
<p>Distribution : 복제를 설정하였을 때 로그 분배를 위해 사용한다.</p>
</li>
</ol>
<h1 id="transact-sql-기초" style="position:relative;"><a href="#transact-sql-%EA%B8%B0%EC%B4%88" aria-label="transact sql 기초 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transact-SQL 기초</h1>
<ul>
<li>SQL 구문의 종류</li>
</ul>
<ul>
<li>
<p>데이터 관리언어(DML) : 데이터입력, 조회, 수정, 삭제(INSERT, SELECT, UPDATE, DELETE)</p>
</li>
<li>
<p>데이터 정의언어(DDL) : 데이터 베이스의 특성과 속성을 정의, 테이블, 인덱스,뷰 등 생성과 수정,삭제(CREATE, ALTER, DROP)</p>
</li>
<li>
<p>데이터 조작언어(DCL) : 데이터베이스 개체에 대한 사용권한을 제어(GRANT,REVOKE,DENY)</p>
</li>
</ul>
<ul>
<li>컬럼 별칭 세가지 방법</li>
</ul>
<p>SELECT GETDATE() AS 일시, 2 수량, 단가=450</p>
<ul>
<li>식별자</li>
</ul>
<ul>
<li>
<p>데이터 베이스 개체 이름</p>
</li>
<li>
<p>예약어나 특수문자가 포함된 경우 식별자 구분을 위해서 구분자 사용함.</p>
</li>
<li>
<p>구분자는 [] , ""(SET QUOTED_IDENTIFIER ON 세션 옵션 설정, OFF일 경우 문자열로 사용)</p>
</li>
</ul>
<p>SELECT *</p>
<p>FROM [MY TABLE] // 공백 문자 포함의 경우 구분</p>
<p>WHERE [ORDER] = 10 // 일부예약어의 경우 구분</p>
<ul>
<li>
<p>논리연산자 : 우선순위 -NOT, AND, OR</p>
</li>
<li>
<p>ORDER BY( 조회자료 정렬)</p>
</li>
</ul>
<ul>
<li>제약사항 : ntext, text, image ORDER BY 절 사용못함.</li>
</ul>
<p>SELECT type, AVG(price) AS avgPrice</p>
<p>FROM titles</p>
<p>WHERE royalty = 10</p>
<p>GROUP BY type</p>
<p>HAVING AVG(price) &#x3C; 80</p>
<ul>
<li>DISTINCT와 GROUP BY절</li>
</ul>
<ul>
<li>
<p>DISTINCT는 주로 UNIQUE(중복을 제거)한 컬럼이나 레코드를 조회</p>
</li>
<li>
<p>GROUP BY는 데이터를 그룹핑해서 그 결과를 가져옴.</p>
</li>
</ul>
<p>예)</p>
<p>– DISTINCT를 사용한 중복 데이터 제거
SELECT DISTINCT deptno FROM emp;</p>
<p>– GROUP BY를 사용한 중복 데이터 제거
SELECT deptno FROM emp GROUP BY deptno;</p>
<h2 id="deptno" style="position:relative;"><a href="#deptno" aria-label="deptno permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DEPTNO</h2>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">30
20
10</code></pre></div>
<ol>
<li>
<p>언제 사용되나?</p>
<p>GROUP BY : 집계함수를 사용하여 특정 그룹으로 구분 할 때는 절을 사용</p>
<p>DISTINCT : 특정 그룹 구분없이 중복된 데이터를 제거할 경우에 사용</p>
</li>
</ol>
<p>예)
SELECT COUNT(DISTINCT d.deptno) “중복제거 수”,
COUNT(d.deptno) “전체 수”
FROM emp e, dept d
WHERE e.deptno = d.deptno;</p>
<p>– 집계 함수가 필요한 경우는 GROUP BY를 사용해야 한다.
SELECT deptno, MIN(sal)
FROM emp
GROUP BY deptno;</p>
<ul>
<li>SELECT INTO / INSERT INTO 차이점</li>
</ul>
<ul>
<li>SELECT INTO : 원본이 있고, 대상 테이블을 새롭게 생성하려는 경우 사용(원본 테이블만 있으면 됨 - 복사되므로)</li>
<li>INSERT INTO : 원본테이블과 복사하는 테이블 둘다 있을 때 사용해야함</li>
</ul>
<ol>
<li>언제 사용되나?</li>
</ol>
<ul>
<li>
<p>SELECT INTO : 복잡한 작업을 하는 경우에 원본 테이블을 그대로 두면서 임시 테이블을 만들어서 하위작업을 하는데 주로 사용됨.</p>
</li>
<li>
<p>INSERT INTO : 원본 테이블의 자료를 복사하기 위해서 사용됨</p>
</li>
</ul>
<ol start="2">
<li>
<p>SELECT INTO 사용법</p>
<p>-원본 있고, 대상 테이블을 새롭게 생성하려는 경우 사용</p>
<p>-SELECT * INTO AA FROM A</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">  -A테이블과 같은 컬럼과 데이터를 가지는 AA라는 테이블 생성</code></pre></div>
<p>1-1 A테이블의 특정 컬럼만 가져오고 싶다면,</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">      SELECT * INTO AA

         FROM ( SELECT COL1, COL2, COL3.....

                           FROM AA

                     ) AS TEMP

 -A테이블의 특정 컬럼만 가져와서 AA라는 테이블을 생성하여 데이터를 INSERT한다.</code></pre></div>
</li>
<li>
<p>INSERT INTO 사용법</p>
</li>
</ol>
<ul>
<li>
<p>INSERT INTO B SELECT * FROM A</p>
<p>-위에서 테이블A와 테이블B는 스키마가 동일해야 한다. ( 데이터 구조, 같은 포맷을 가진 테이블)</p>
</li>
<li>
<p>INSERT INTO B SELECT COL1,COL2,COL3 FROM A</p>
<p>-만일 A보다 컬럼수가 적으면 SELECT뒤에 컬럼을 명시해준다</p>
</li>
</ul>
<ul>
<li>조인 : 두 개 이상의 테이블로부터 쿼리하여 하나의 결과물을 만드는 연산</li>
</ul>
<ol>
<li>내부 조인(INNER JOIN) / 외부(OUTER JOIN)</li>
</ol>
<p>● INNER JOIN</p>
<ul>
<li>
<p>ANSI 표준 : SELECT a.id, a.val aval, b.val bval FROM A a INNER JOIN B b ON a.id = b.id;</p>
</li>
<li>
<p>Transact-SQL : SELECT a.id, a.val aval, b.val bval FROM A a ,B b WHERE a.id = b.id;</p>
</li>
</ul>
<p>● LEFT OUTER JOIN</p>
<ul>
<li>
<p>ANSI 표준 : SELECT a.id, a.val aval, b.val bval FROM A a LEFT OUTER JOIN B b ON a.id = b.id;</p>
</li>
<li>
<p>Transact-SQL : SELECT a.id, a.val aval, b.val bval FROM A a , B b WHERE a.id *= b.id;</p>
</li>
</ul>
<p>● RIGHT OUTER JOIN</p>
<ul>
<li>
<p>ANSI 표준 : SELECT a.id, a.val aval, b.val bval FROM A a RIGHT OUTER JOIN B b ON a.id = b.id;</p>
</li>
<li>
<p>Transact-SQL : SELECT a.id, a.val aval, b.val bval FROM A a , B b WHERE a.id =* b.id;</p>
</li>
</ul>
<ul>
<li>UNION</li>
</ul>
<ul>
<li>
<p>JOIN : 두 테이블이나 결과물을 병렬조합</p>
<p>UNION : 쿼리의 결콰를 상하위로 합치는 직렬 조합</p>
</li>
<li>
<p>UNION한 결과 전체에 대해서 GROUP BY 및 HAVING 절 사용하기 위해서는 임시테이블, 파생테이블 사용</p>
</li>
</ul>
<p>SELECT stor_ID AS StoreID, Qty*2 AS Quantity
INTO #SalesTemp FROM sales</p>
<p>SELECT StoreID, SUM(Quantity)
FROM
( SELECT Stor_ID AS StoreID, Qty AS Quantity FROM sales
UNION ALL
SELECT * FROM #SalesTemp
) t
GROUP BY StoreID</p>
<p>결과)</p>
<p>6380 24
7066 375</p>
<ul>
<li>DELETE / UPDATE</li>
</ul>
<ul>
<li>
<p>DELETE FROM authors WHERE au_lname = ‘McBadden’</p>
</li>
<li>
<p>UPDATE authors SET state = ‘PC’ WHERE state = ‘CA’</p>
</li>
</ul>
<ul>
<li>INSERT</li>
</ul>
<ul>
<li>
<p>INSERT 문은 VALUE절과 함께 사용시 INTO 절을 생략가능</p>
</li>
<li>
<p>삽입에서 명시되지 않아도 되는 컬럼</p>
<ol>
<li>
<p>NULL 허락한 컬럼</p>
</li>
<li>
<p>기본값을 가진 컬럼</p>
</li>
<li>
<p>자동 증가형 속성을 가진 컬럼</p>
</li>
<li>
<p>Rowversion or Timestamp 가진 컬럼</p>
</li>
</ol>
</li>
</ul>
<ul>
<li>TRUNCATE TABLE / DELETE</li>
</ul>
<ul>
<li>
<p>WHERE 절이 없는 DELETE 문과 동일함</p>
</li>
<li>
<p>DELETE : 자동증가형 속성이 유지 / TRUNCATE : 자동증가형 속성이 초기화됨</p>
</li>
<li>
<p>DELETE 빠르고 트랜잭션 로그 리소스를 덜 사용 -DELETE 한 행 제거 후 각 행에 대해서 트랜잭션 로그 항목 기록</p>
</li>
<li>
<p>TRUNCATE는 행별 삭제되는 내용이 로그되지 않아서 DELETE 트리거 작동안함</p>
<p>트리거 : 특정 테이블에 자료가 수정될때 내부적으로 관련된 다른 테이블 또는 컬럼에 자동으로 연동하여서 무결성을 지키기 위한 것</p>
</li>
</ul>
<h1 id="db-생성과-관리" style="position:relative;"><a href="#db-%EC%83%9D%EC%84%B1%EA%B3%BC-%EA%B4%80%EB%A6%AC" aria-label="db 생성과 관리 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DB 생성과 관리</h1>
<ul>
<li>
<p>데이터 베이스 : 관리하고 싶은 업무 단위와 관련된 오브젝트를 하나의 논리적인 저장소 단위로 일관성을 유지할 수 있는 관리의</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                  단위이며 복구의 단위</code></pre></div>
</li>
<li>
<p>데이터베이스 기본적인 구성 : 파일 그룹 / 데이터 파일 / 로그파일</p>
<ol>
<li>
<p>파일 그룹 : 여러 데이터 파일의 논리적인 집합</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">             디스크를 분산하여 성능을 향상을 고려할 수 있음.</code></pre></div>
</li>
<li>
<p>데이터베이스 파일 : 데이터 파일과 로그 파일로 나눌 수 있으며 자료를 기록하는 물리적인 저장소 단위를 말함.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                        주파일 : 데이터베이스 시작정보와 데이터저장 / 보조파일 : 그 외 파일

                        트랜잭션 로그파일 : 데이터 복구에 필요한 로그 정보가 저장</code></pre></div>
</li>
<li>
<p>익스텐트 : 테이블과 인덱스에 할당되는 기본단위(하나의 익스텐트는 연속하는 8 페이지(64KB)로 구성됨)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">           기존에 할당한 저장공간이 부족할 경우 새로운 익스텐트를 할당받고 첫페이지부터 사용하게 된다.</code></pre></div>
</li>
<li>
<p>데이터파일 : 익스텐트를 할당할 수 있는 물리적으로 확보된 공간</p>
</li>
<li>
<p>페이지 : 페이지는 SQL 서버에서 데이터 저장소의 기본 단위</p>
</li>
</ol>
</li>
<li>
<p>데이터베이스 생성</p>
<ol>
<li>
<p>데이터베이스 : 여러 개의 데이터파일과 로그 파일로 구성</p>
</li>
<li>
<p>여러 개의 물리적인 드라이브를 가지는 경우에 데이터파일은 여러개의 파일 그룹에 분산하여 하드디스크 I/O 분산하여 처리함.</p>
<p>로그 크기는 데이터수정량과 로그의 백업일정에 따라서 다르며 기본적으로 10~25%</p>
</li>
</ol>
</li>
</ul>
<p>CREATE DATABASE [Testpubs] ON PRIMARY
(NAME = N’Testpubs_Data’
,FILENAME = N’C:\TEMP\Testpubs_Data.MDF’
,SIZE = 5, MAXSIZE=100
,FILEGROWTH=10%)
LOG ON
(NAME = N’Testpubs_Log’
,FILENAME = N’C:\TEMP\Testpubs_Log.LDF’
,SIZE = 2
,FILEGROWTH=1MB)</p>
<p>● ON : 데이터부분이 저장되는 데이터파일을 명시적으로 정의</p>
<p>● PRIMARY : 주파일 정의</p>
<p>● NAME : 논리적 이름</p>
<p>● LOG ON : 데이터베이스 로그가 저장되는 디스크 파일을 명시적으로 정의함.</p>
<p>● FOR LOAD : 데이터베이스의 백업자료로 복구하며, 초기화하기 위한 옵션</p>
<p>● FOR ATTACH : 기존 운영체제 파일 집합에서 데이터베이스 연결 하기 위한 옵션</p>
<ul>
<li>파일 크기 늘이기와 새로운 파일 추가</li>
</ul>
<p>ALTER DATABASE [Testpubs] MODIFY FILE
(NAME = ‘Testpubs_Data’
,SIZE = 10)</p>
<p>ALTER DATABASE [Testpubs] ADD FILEGROUP [Second]</p>
<p>ALTER DATABASE [Testpubs] ADD FILE
(NAME = N’Testpubs_Data2’
,FILENAME = N’C:\Temp\Testpubs_Data2.NDF’
,SIZE = 1, FILEGROWTH = 10%
) TO FILEGROUP [Second]</p>
<ul>
<li>파일 그룹의 사용</li>
</ul>
<ul>
<li>
<p>파일 그룹은 테이블과 인덱스, BLOB형 자료, 즉 Image, text, ntext 데이터형을 저장될 공간을 명시적으로 할당함.</p>
</li>
<li>
<p>BLOB(Binary Large Object)</p>
</li>
</ul>
<p>ALTER DATABASE [Testpubs] ADD FILEGROUP [FG_Index]
ALTER DATABASE [Testpubs] ADD FILEGROUP [FG_BLOB]</p>
<p>ALTER DATABASE [Testpubs] ADD FILE
(NAME = N’Textpubs_Data3’
,FILENAME = N’C:TEMP\Testpubs_Data3.NDF’
,SIZE = 1
,FILEGROWTH = 10%) TO FILEGROUP [FG_Index]</p>
<p>– BLOB Binary Large Object 약자로 image,text,ntext 데이터형<br>
ALTER DATABASE [Testpubs] ADD FILE
(NAME = N’Textpubs_BLOB’
,FILENAME = N’C:TEMP\Testpubs_BLOB.NDF’
,SIZE = 1
,FILEGROWTH = 10%) TO FILEGROUP [FG_BLOB]</p>
<p>CREATE TABLE [pub_info]
([pub_id][char] (4) PRIMARY KEY ON [FG_Index] NOT NULL
,[pub_name]<a href="10">char</a> NOT NULL
,[logo][image] NULL
,[pr_info][text] NULL )
ON [PRIMARY]
TEXTIMAGE_ON [FG_BLOB]</p>
<ul>
<li>데이터베이스 축소</li>
</ul>
<ol>
<li>자동파일 축소 : 주기적으로 사용공간의 25% 빈 여우공간을 두고 축소하여 운영체에 반납한다.</li>
</ol>
<p>DBCC SHRINKFILE(Testpubs_Data, 25) - 30분간격으로 주기적으로 작업</p>
<ol start="2">
<li>파일 수동 축소</li>
</ol>
<p>● EMPTYFILE : 모든 데이터를 동일한 파일 그룹의 다른 파일로 이동시키고 빈파일로 남김</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                     해당 파일을 물리적으로 다른 공간을 이동시키고 제거하는 목적</code></pre></div>
<p>DBCC SHRINKFILE(Testpubs_Data2, EMPTYFILE)</p>
<p>ALTER DATABASE Testpubs REMOVE FILE Testpubs_Data2</p>
<p>● NOTRUNCATE : 해제된 파일 공간을 파일에 보유하고 해제된 공간을 운영체제에 반환하지 않는다.</p>
<p>● TRUNCATEONLY : 파일에 사용되지 않은 공간을 운영체제에 반환, 데이터를 이동하지 않고 파일 크기를 줄인다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                            TRUNCATEONLY 사용시 target_size는 무시된다.</code></pre></div>
<p>DBCC SHRINKFILE(Testpubs_Data, 5, [EMPTYFILE | NOTRUNCATE|TRUNCATEONLY )</p>
<ol start="3">
<li>데이터베이스 수동 축소</li>
</ol>
<ul>
<li>
<p>지정한 데이터베이스에서 모든 데이터파일과 로그 파일을 축소하기 위해서 사용함.</p>
</li>
<li>
<p>ALTER DATABASE, DBCC SHRINKFILE 명시적으로 설정한 최종크기보다 작게 만들 수는 없다.</p>
</li>
</ul>
<p>DBCC SHRINKDATABASE(Testpubs, 25) 25% 빈공간을 두고 축소(NOTRUNCATE , TRUNCATEONLY )</p>
<ul>
<li>
<p>데이터베이스 변경 및 삭제</p>
<ol>
<li>파일 그룹 변경</li>
</ol>
</li>
</ul>
<ul>
<li>
<p>sp_help : 데이터베이스 개체, 사용자 정의 데이터 형식 또는 데이터 형식에 대한 정보를 보고</p>
</li>
<li>
<p>Data_located on_filegroup -FG_Index</p>
</li>
</ul>
<p>ALTER DATABASE Testpubs
MODIFY FILEGROUP [FG_Index] DEFAULT</p>
<p>CREATE TABLE Test( id int)</p>
<p>EXEC sp_help Test</p>
<ol start="2">
<li>데이터베이스명 변경</li>
</ol>
<ul>
<li>
<p>데이터베이스 이름 변경 시 단일 사용자 모드, 변경 후 다시 단일사용자 모드 해제</p>
</li>
<li>
<p>ROLLBACK IMMEDIATE : 완료되지 않은 트랜잭션을 롤백하기 위해서 옵션을 넣어준다.</p>
</li>
</ul>
<p>ALTER DATABASE Testpus
SET SINGLE_USER WITH ROLLBACK IMMEDIATE</p>
<p>EXEC sp_renamedb ‘Testpubs’, ‘TestpubsNew’</p>
<p>EXEC sp_dboption TestpubsNew, ‘Single user’, FALSE</p>
<ol start="3">
<li>데이터베이스 삭제</li>
</ol>
<p>DROP DATABASE TestpubsNew</p>
<ul>
<li>
<p>데이터베이스 옵션</p>
<ol>
<li>자동옵션</li>
</ol>
<p>● AUTO_CLOSE : 데이터베이스를 마지막으로 사용한 사용자가 종료, 데이터베이스 종료되면 데이터베이스 리소스가 해제된다.</p>
<p>● AUTO_CREATE_STATISTICS : 조건자에서 사용되는 열에 대해 자동으로 통계가 생성된다.</p>
<p>● AUTO_UPDATE_STATISTICS : 데이터가 변경되고 기존 통계가 최신 상태가 아닐때 통계를 자동으로 업데이트 한다.</p>
<p>● AUTO_SHRINK : 데이터베이스의 데이터파일과 로그 파일의 사용되지 않는 공간을 정기적으로 검사해서 축소한다.</p>
<ol start="2">
<li>커서옵션</li>
</ol>
<p>● CURSOR_CLOSE_ON_COMMIT : 트랜잭션이 커밋될때 열려 있던 커서가 자동으로 닫힌다.</p>
<p>● CURSOR_DEFAULT_LOCAL/GLOBAL : 설정된 커서의 범위가 로컬로 적용, 연결된 세션의 전역으로 적용</p>
<ol start="3">
<li>복구옵션 / 상태옵션(SINGLE, READ_ONLY) / Nonlogged Operation(로그 파일에 기록을 남기지 않는 경우) / WITH<termination></li>
</ol>
</li>
</ul>
<p>ALTER DATABASE Testpus
SET SINGLE_USER WITH ROLLBACK AFTER 300(초)</p>
<p>EXEC sp_renamedb ‘Testpubs’, ‘TestpubsNew’</p>
<p>EXEC sp_dboption TestpubsNew, ‘Single user’, FALSE</p>
<ul>
<li>
<p>로그의 역할</p>
<ul>
<li>
<p>로그는 해당 데이터베이스에 수정작업 모두를 기록해서 서버의 장애로 COMMIT을 하지 못할 경우에는 ROLLBACK을 수행해서</p>
<p>데이터의 일관성을 유지하게 된다.</p>
</li>
<li>
<p>트랜잭션 로그 기록사항</p>
<p>트랜잭션의 시작과 끝, 모든 데이터 수정과 변경된 내용이 포함, 모든 익스텐트 할당, 취소</p>
<p>테이블 또는 인덱스 만들기 또는 삭제</p>
</li>
</ul>
</li>
</ul>
<h1 id="데이터형식-및-형변환" style="position:relative;"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%98%95%EC%8B%9D-%EB%B0%8F-%ED%98%95%EB%B3%80%ED%99%98" aria-label="데이터형식 및 형변환 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터형식 및 형변환</h1>
<ul>
<li>
<p>가변 길이 데이터형</p>
<p>가변 크기 데이터형 : varchar, varbinary, nvarchar</p>
<p>크기고정X, 명시 할 수 없는 데이터형 : text, ntext, image, sql_variant</p>
<ul>
<li>text, image는 테이블 내의 저장소가 아닌 별도의 공간에 저장, 해당 저장소의 시작주소 16바이트를 가지고 운영함.</li>
</ul>
</li>
<li>
<p>가변길이, 고정길이 언제 사용?</p>
<p>가변길이 : 큰 고정문자형을 정의하고 적은 크기 문자열을 사용할 때</p>
<p>고정길이 : 입력포맷(3글자)이 고정되어 있는 곳에서는 고정길이를 쓰는 것이 더 좋은 성능을 얻을 수 있음</p>
</li>
<li>
<p>유니코드</p>
</li>
</ul>
<p>SELECT ASCII(‘A’) AS ASCIIA ,UNICODE(N’가’) AS UNICODE가</p>
<p>SELECT CHAR(65) AS CHAR65 ,NCHAR(44032) AS CHAR44032</p>
<p>=65, 44032 / A, 가</p>
<ul>
<li>숫자형 데이터 형식</li>
</ul>
<ol>
<li>
<p>정확한 숫자 : decimal, numeric</p>
</li>
<li>
<p>근사 숫자 : float, real(float(24))</p>
</li>
</ol>
<p>CREATE Table TestFloat
(xNumeric Numeric(7,3) //DEFAULT 시 전체자리수 18, 소수점 이하 자릿수 0
,xDecimal Decimal(7,3)
,xFloat Float //근사값 저장되며 내부적으로 계산이 진행됨.
,xReal Real)</p>
<p>INSERT TestFloat VALUES(3,3,3,3)
INSERT TestFloat VALUES(12.3,12.3,12.3,12.3)
SELECT * FROM TestFloat</p>
<p>3.000 3.000 3 3
12.300 12.300 12.3000000001 12.3</p>
<ul>
<li>
<p>datetime(밀리초) / smalldatetime(분)</p>
</li>
<li>
<p>대형 데이터 형식</p>
<ul>
<li>
<p>대형 데이터를 저장하기 위해서는 text, ntext, image 데이터형</p>
</li>
<li>
<p>2G 저장 가능, 직접 해당 데이터페이지를 저장하지 않으며. 16바이트 포인터만 저장하고 실제로는 별도의 저장공간이 있음.</p>
</li>
</ul>
</li>
<li>
<p>기타 데이터 형식</p>
<ol>
<li>Timestamp 및 rowversion(8 Byte)</li>
</ol>
<p>● 데이터베이스 안에서 각 행의 자료에 대한 버전 관리</p>
<p>● 데이터베이스에서 고유함이 보장된 자동 생성 이진수를 표시</p>
<p>● 테이블 당 하나만 설정</p>
<p>● @@DBTS 함수로 마지막으로 적용된 버전 넘버를 알 수 있다.</p>
<p>● =,&#x3C;>,&#x3C;,>,&#x3C;=,>= 단순 비교 사용가능</p>
<p>● 삭제에는 버전이 증가하지 않고 삽입에서만 가능함.</p>
</li>
</ul>
<p>CREATE TABLE TestTimeStamp
(ID int PRIMARY KEY
,Name char(10)
,xTimeStamp Timestamp)</p>
<p>CREATE TABLE TestRowversion
(ID int PRIMARY KEY
,Name char(10)
,xRowVersion rowversion)</p>
<p>INSERT TestTimeStamp(ID, NAME) Values(1, ‘홍길동’)
INSERT TestRowversion(ID, NAME) Values(1, ‘홍길동’)</p>
<p>SELECT @@DBTS</p>
<ol start="2">
<li>
<p>Sql_variant</p>
<p>● 하나의 컬럼에 여러 데이터형 저장을 지원하기 위한 데이터형</p>
<p>● ntext, text, image, timestamp,sql_variant 지정 불가능</p>
</li>
</ol>
<ul>
<li>
<p>sql_variant 제약 및 특징</p>
<ol>
<li>
<p>연산에 사용되기전에 기본 데이터 형식 값으로 변환되어야 한다.</p>
<p>SELECT CONVERT(int, @MyVar1) + CONVERT(int, @MyVal2)</p>
</li>
<li>
<p>최대 8016 바이트 이상 길이 가질 수 없다.</p>
</li>
<li>
<p>IDENTITY 속성 설정 불가능</p>
</li>
<li>
<p>대표키나 참조키 사용가능</p>
</li>
<li>
<p>ATLTER TABLE 구문을 이용하여 text, ntext, image, timestamp, sql_variant 형 바꿀 수 없다.</p>
</li>
</ol>
</li>
</ul>
<p>DECLARE @MyVal1 AS sql_variant
DECLARE @MyVal2 AS sql_variant
SET @MyVal1 = 1
SET @MyVal2 = ‘2’
SELECT CONVERT(int, @MyVal1) + CONVERT(int, @MyVal2)</p>
<ol start="3">
<li>
<p>Uniqueidentifier</p>
<ul>
<li>GUID형을 나타내기 위한 데이터 형식</li>
</ul>
</li>
</ol>
<p>CREATE TABLE MyUniqueTable
(UniqueID UNIQUEIDENTIFIER DEFAULT NEWID()
,Characters char(10))</p>
<ul>
<li>
<p>TABLE</p>
<ul>
<li>
<p>테이블 구조의 변수를 선언</p>
</li>
<li>
<p>table 변수는 배치 처리가 완료됨과 동시에 자동으로 제거된다.</p>
</li>
</ul>
</li>
</ul>
<p>DECLARE @TableVar TABLE
(ID int PRIMARY KEY,
Name nchar(10))</p>
<p>INSERT INTO @TableVar VALUES (1, N’홍’)
INSERT INTO @TableVar VALUES (2, N’승아’)</p>
<ul>
<li>
<p>사용자 정의 데이터형식</p>
<ul>
<li>sp_bindrule : 열 또는 별칭 데이터 형식에 규칙을 바인딩</li>
</ul>
</li>
</ul>
<p>CREATE RULE ZipCode_rule
AS @value LIKE ‘[0-9][0-9][0-9]-[0-9][0-9][0-9]’</p>
<p>EXEC sp_bindrule ‘ZipCode_rule’, ‘ZipCode’</p>
<ul>
<li>
<p>데이터 형변환</p>
<ol>
<li>
<p>묵시적 형변환</p>
<p>SELECT 4/3, 4/3.0 -1 / 1.3333 SELECT ‘1’ + 2 , ‘1’+‘2’-3 , 12</p>
</li>
<li>
<p>NULL 연산 : NULL 연산은 항상 NULL</p>
<p>SET CONCAT_NULL_YIELDS_NULL ON일 경우 -문자열 NULL</p>
</li>
<li>
<p>명시적 형변환(CAST, CONVERT)</p>
</li>
</ol>
<ul>
<li>STR(float_expression [ , length [ ,decimal ] ] )</li>
</ul>
</li>
</ul>
<p>float_expression : 소수점이 있는 근사치(float) 데이터 형식의 식입니다. 10자리가 넘을 경우 * 표현됨
length 총길이, 기본값은 10입니다.
decimal 16자리보다 클 경우 잘리게 됨</p>
<p>예) SELECT ’&#x3C;’ + STR(11.1234) + ’>’
&#x3C; 11></p>
<h1 id="테이블과-제약-조건-생성과-사용" style="position:relative;"><a href="#%ED%85%8C%EC%9D%B4%EB%B8%94%EA%B3%BC-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%EC%83%9D%EC%84%B1%EA%B3%BC-%EC%82%AC%EC%9A%A9" aria-label="테이블과 제약 조건 생성과 사용 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테이블과 제약 조건 생성과 사용</h1>
<ul>
<li>
<p>개체 식별자</p>
<ul>
<li>
<p>서버, 데이터베이스, 테이블 뷰,열 등등 고유한 이름 즉 식별자를 가진다.</p>
</li>
<li>
<p>구분 기호는 [] , "" 사용가능</p>
<p>"" -QUOTED_IDENTIFIER ON일 경우 사용가능</p>
</li>
</ul>
<ol>
<li>식별자 규칙</li>
</ol>
<p>● 식별자 1-128개의 문자로 이루어짐</p>
<p>● @(at기호) : 지역변수, 매개변수 / # : 임시테이블, 프로시저 / ## : 전역 임시 테이블</p>
<p>● Transact-SQL @@ : @@IDENTITY</p>
<p>● 예약어, 중간공백, 특수문자 사용불가능</p>
<p>CREATE TABLE [$Emplayee Data] -구분기호 사용시 식별자로 사용가능</p>
</li>
<li>
<p>임시테이블, 테이블 변수</p>
<ol>
<li>
<p>공통점 : 임시적으로 테이블을 사용하고 폐기하기 위해서 사용</p>
</li>
<li>
<p>다른점</p>
<ul>
<li>
<p>임시테이블 : DROP Table 강제로 제거, 세션이 끊기면 자동 삭제</p>
</li>
<li>
<p>테이블 변수 : 쿼리 분석기에서 GO 분리자를 넘어서면 자동으로 파기됨.</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>CREATE TABLE #cnst_example</p>
<p>(</p>
<p>…</p>
<p>) INTO #cnst_exam</p>
<p>DECLARE @cnst_example TABLE</p>
<p>(</p>
<p>…</p>
<p>)</p>
<ul>
<li>테이블 생성</li>
</ul>
<ol>
<li>[ON { &#x3C;파일그룹| DEFAULT }]</li>
</ol>
<p>CREATE TABLE [pub_info]
([pub_id] [char] (4) PRIMARY KEY ON [FG_Index] NOT NULL // pub_id FG_Index 파일그룹
,[pub_name] [char] (10) NOT NULL
,[logo] [image] NULL
,[pr_info] [text] NULL)
ON [PRIMARY] // Default만 Primary
TEXTIMAGE_ON [FG_BLOB] // logo, pr_info 파일 그룹</p>
<ol start="2">
<li>NOT FOR REPLICATION</li>
</ol>
<ul>
<li>복제를 통해 삽입되는 자료에 대해 새로운 증가값을 받지 않고 그대로 삽입</li>
</ul>
<p>CREATE TABLE Sales1
(SaleID INT IDENTITY(1, 1) NOT FOR REPLICATION,
CHECK NOT FOR REPLICATION (SaleID &#x3C;= 99999)
,SalesRegion CHAR(2)
,CONSTRAINT ID_PK PRIMARY KEY (SaleID))</p>
<p>SET IDENTITY_INSERT Sales ON</p>
<p>INSERT INTO sales1(SaleID, SalesRegion) SELECT s2.SaleID, s2.SalesRegion FROM sales2 S2</p>
<p>SET IDENTITY_INSERT Sales OFF</p>
<p>INSERT INTO Sales1 VALUES(‘H0’);</p>
<p>1 ‘ho’</p>
<p>2 ‘hk’</p>
<p>1000 ‘hu’</p>
<p>1001 ‘ha’</p>
<p>3 ‘hi’</p>
<ol start="3">
<li>
<p>ROWGUIDCOL</p>
<ul>
<li>
<p>uniqueidentifier 컬럼에만 ROWGUIDCOL 지정가능, 컴럼 고유 식별자 컬럼이란 것을 나타냄</p>
</li>
<li>
<p>속성 설정시 컬럼의 값이 생성되지 않고 INSERT로 삽입 시 생성됨.</p>
</li>
</ul>
</li>
</ol>
<p>CREATE TABLE TestGUIDCOL
(Seq int IDENTITY PRIMARY KEY
,GUIDCOL uniqueidentifier DEFAULT(NEWID()) ROWGUIDCOL
,Message varchar(5000))</p>
<p>INSERT TestGUIDCOL (Message) VALUES(‘ROWGUIDCOL TEST’)
INSERT TestGUIDCOL (Message) VALUES(‘IDENTITYCOL TEST’)</p>
<p>SELECT ROWGUIDCOL, Message
FROM TestGUIDCOL
WHERE IDENTITYCOL = 1 // IDENTITY의 행을 비교하는 구문</p>
<ol start="4">
<li>CONSTRAINT</li>
</ol>
<ul>
<li>제약 조건을 정의함( 제약조건 : PRIMARY KEY, UNIQUE, CHECK 제약 등)</li>
</ul>
<p>CREATE TABLE Sales</p>
<p>(</p>
<p>…</p>
<p>, CONSTRAINT PK_Sales PRIMARY KEY NONCLUSTERED</p>
<p>(</p>
<p>SaleDate, SlipNo</p>
<p>)</p>
<p>)</p>
<ul>
<li>IDENTITY</li>
</ul>
<p>● 컴럼에 정수값을 자동증가 및 감소되는 속성을 정의</p>
<p>● CREATE ,ALTER TABLE 문으로 컬럼에 정의</p>
<p>● 사용이유 : 유일한 식별자를 만들고 기본키로 사용하기 위해서사용</p>
<ol>
<li>IDENTITY 속성</li>
</ol>
<p>CREATE TABLE TestIDENTITY
(ID int PRIMARY KEY IDENTITY(1000, 2), NAME char(10)) - 초기값, 증가치</p>
<ol start="2">
<li>
<p>@@IDENTITY : 마지막 ID 리턴함.</p>
<p>SET IDENTITY_INSERT를 ON할 경우 IDENTITY값을 수정가능</p>
<p>=유일값으로 설정하고 싶은 경우 PRIMARY KEY, UNIQUE KEY로 설정</p>
</li>
<li>
<p>IDENTITYCOL 예약어</p>
</li>
</ol>
<ul>
<li>
<p>IDENTITY 컬럼행 리턴함. ( WHERE 사용 )</p>
<p>WHERE IDENTITYCOL = 1</p>
</li>
</ul>
<ol start="4">
<li>DBCC CEHCKIDENT</li>
</ol>
<ul>
<li>
<p>사용이유 : IDENTITY 속성 최대치에 넘어설 경우 오버플로우 오류, 초기치 설정가능</p>
<p>DBCC CHECKIDENT(TestIDENTITY, RESEED, 500)</p>
</li>
</ul>
<ol start="5">
<li>@@IDENTITY 함수</li>
</ol>
<ul>
<li>해당 세션에서 마지막으로 적용된 자동 증가값을 반환</li>
</ul>
<ul>
<li>
<p>계산된 컬럼</p>
<ul>
<li>물리적으로 저장되지 않은 가상컬럼(계산식으로 사용)</li>
</ul>
</li>
</ul>
<p>CREATE TABLE Sales</p>
<p>( CustomerId int not null</p>
<p>Amt AS ROUND(Qty*Price, -2)</p>
<p>)</p>
<p>INSERT INTO Sales VALUES(1115)</p>
<ul>
<li>테이블 수정 / 삭제</li>
</ul>
<p>CREATE TABEL TestAlterTable( column_a INT)</p>
<p>ALTER TABLE TestAlterTable ADD column_b varchar(20) NULL</p>
<p>ALTER COLUMN column_b int</p>
<p>DROP COLUMN column_b</p>
<p>DROP TABLE TestAlterTable</p>
<ul>
<li>제약조건</li>
</ul>
<p>● ALTER TABLE Customers ADD CONSTRAINT PK_Customers PRIMARY KEY CLUSTERED</p>
<p>● 데이터 무결성 : 일관된 자료를 유지하기 위한 방법</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                       제약사항, 기본값, 자료삽입, 수정 삭제를 통해서 지켜야할 기준을 유지함.</code></pre></div>
<p>● 참조무결성 : 기본키와 외래키의 관계를 유지(FOREIGN KET, CHECK)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                   CASECADE DELETE, CASECADE UPDATE</code></pre></div>
<p>● 엔티티무결성 : 특정 테이블의 고유 엔티티 정의(PRIMARY, UNIQUE)</p>
<p>● 도메인무결성 : 주워진 열에 데이터가 유효하도록 함(CHECK, DEFAULT, NOT NULL)</p>
<ol>
<li>제약조건</li>
</ol>
<ul>
<li>NOCECK 옵션 : FOREIGN KEY 가지고 있지 않은 테이블에서 참조 무결성을 어기는 기존의 문제는 점검하지 않고 제약 생성</li>
</ul>
<p>ALTER TABLE [Order Details] WITH NOCHECK ADD CONSTRAINT [FK_Order_Details_Orders] FOREIGN KEY</p>
<p>(</p>
<p>[OrderID]</p>
<p>) REFERENCES [Orders]</p>
<p>(</p>
<p>[OrderID]</p>
<p>)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">- DEFAULT 제약

  ● INSERT 구문 사용시 입력되어야 할 값을 명시하지 않을 경우 DEFAULT 값이 대신들어감

- CHECK 제약</code></pre></div>
<p>ALTER TABLE ZipCode
ADD
CONSTRAINT chk_ZipCode //check 제약조건 chk_ZipCode 만들고 INSERT 확인함.
CHECK( phone LIKE ‘[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]‘)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">- PRIMARY KEY / UNIQUE

  ● PRIMARY : 유일한 식별자, 참조의 무결성을 위한 후보키 사용, NULL 포함X

  ● UNIQUE : 유일한 식별자, 참조의 무결성을 위한 후보키 사용, NULL 포함O

- FOREIGN KEY 제약조건

  ● 같은 서버의 같은 데이터베이스 내에 있는 테이블만 참조가 가능

  ● 외래키를 만들어서 참조 무결성을 구현

      ALTER TABLE [Order Details] WITH NOCHECK ADD CONSTRAINT [FK_Order_Details_Orders] FOREIGN KEY</code></pre></div>
<p>(</p>
<p>[OrderID]</p>
<p>) REFERENCES [Orders]</p>
<p>(</p>
<p>[OrderID]</p>
<p>) ON DELETE CASCADE</p>
<p>// ON UPDATE CASCADE</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> ON DELETE NO ACTION
 다른 테이블의 기존 행에 있는 외래 키에서 참조하는 키가 포함된 행을 삭제/갱신하려고 하면 오류가 발생하고 UPDATE, DELETE

 문이 롤백되도록 지정



● DELETE/UPDATE CASCADE 제약 조건 정의 안할경우(트랜잭션 이용)

   BEGIN TRAN</code></pre></div>
<p>DELETE [Order Details] WHERE OrderID= 10248</p>
<p>DELETE Orders WHERE OrderID = 10248</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">   END TRAN</code></pre></div>
<h1 id="시스템-지원-함수-및-연산자" style="position:relative;"><a href="#%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%A7%80%EC%9B%90-%ED%95%A8%EC%88%98-%EB%B0%8F-%EC%97%B0%EC%82%B0%EC%9E%90" aria-label="시스템 지원 함수 및 연산자 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>시스템 지원 함수 및 연산자</h1>
<ul>
<li>수치연산 함수</li>
</ul>
<ol>
<li>
<p>CEILING, FLOOR</p>
<ul>
<li>SELECT CEILING(11.55), CEILING(11.11), FLOOR(11.11), FLOOR(11.55) -12, 12, 11, 11</li>
</ul>
</li>
<li>
<p>ROUND</p>
<ul>
<li>SELECT ROUND(11.22, 1) , ROUND(1111.2, -2) -11.20, 1100.0</li>
</ul>
</li>
<li>
<p>RAND</p>
<ul>
<li>INSERT INTO TestSales VALUE(RAND()*26) -0~25 사이에 임의의 값 생성</li>
</ul>
</li>
<li>
<p>POWER(X, Y) Y승, SQRT 제곱근</p>
</li>
</ol>
<ul>
<li>문자열 함수</li>
</ul>
<ol>
<li>LTRIM, RTRIM(공백제거)</li>
</ol>
<p>SELECT ’&#x3C;’ + LTRIM(’ SQL서버 ’) + ’>’ - &#x3C;SQL 서버 ></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> ,'&lt;' + RTRIM('    SQL서버     ') + '>'     - &lt;      SQL 서버>

 , '&lt;' + LTRIM(RTRIM('    SQL서버     ')) + '>'   - &lt;SQL 서버></code></pre></div>
<ol start="2">
<li>REPLICATE</li>
</ol>
<p>SELECT REPLICATE(‘OK’,4), ‘A’ + SPACE(5)+‘B’ - OKOKOKOK A B</p>
<ol start="3">
<li>
<p>REPLACE, STUFF</p>
<p>SELECT REPLACE(‘대한 민국 만세’,‘민국’,‘독립 만’), - 대한 독립 만 만세</p>
<p>STUFF(‘대한 민국 만세’,‘민국’,3,4,‘독립 만’) - 대한독립 만만세</p>
</li>
<li>
<p>CHARINDEX, PATINDEX</p>
<p>CHARINDEX(‘com’, title) -patten 시작 위치점 반환</p>
<p>PATINDEX(‘%c[a-k]n%] -여러가지 옵션 사용가능.</p>
</li>
<li>
<p>DEFFERENCE( 일치도 높으면 4, 낮으면 0, 한글 지원x)</p>
<p>DEFFERENCE(‘can’, ‘con’) -3</p>
</li>
</ol>
<ul>
<li>
<p>날짜 및 시간 함수</p>
<ol>
<li>
<p>DATEADD</p>
<p>SELECT 월시작일 = DATEADD(dd, 1, date)</p>
</li>
<li>
<p>DATEDIFF</p>
<p>DATEDIFF(dd, newdate, olddate)</p>
</li>
<li>
<p>DATEPART</p>
<p>DATEPART(mm, GETDATE())</p>
</li>
<li>
<p>DATANAME</p>
<p>DATENAME(dw, GETDATE())</p>
</li>
</ol>
</li>
<li>
<p>시스템 함수</p>
<ol>
<li>CAST and CONVERT</li>
</ol>
<p>CAST(11.11 AS char(10) , CONVERT(char(10) , 11.11)</p>
<ol start="2">
<li>
<p>COALESCE - 여러 컬럼 값 중 첫번째로 NULL이 아닌 값을 반환</p>
</li>
<li>
<p>@@IDENTITY 세션에서 마지막에 부여된 Identity 값을 반환</p>
</li>
<li>
<p>ISDATE, ISNULL(ISNULL(qty, 0)), ISNUMERIC</p>
</li>
<li>
<p>@@ROWCOUNT</p>
</li>
</ol>
<p>SELECT GETDATE() - 2001-10-22~~</p>
<p>SELECT @@ROWCOUNT</p>
<ol start="6">
<li>@@TRANCOUNT</li>
</ol>
<p>BEGIN TRANSACTION</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> ...</code></pre></div>
<p>SELECT @@TRANCOUNT - 1</p>
<p>BEGIN TRANSACTION</p>
<p>…</p>
<p>SELECT @@TRANCOUNT - 2</p>
<ol start="7">
<li>
<p>NULLIF(두값이 같으면 NULL, 아니면 첫번째 값을 반환)</p>
<p>NULLIF(10, 10), NULLIF(10, 20)</p>
</li>
</ol>
</li>
<li>
<p>연산자</p>
<ol>
<li>비트연산자</li>
</ol>
<ul>
<li>
<p>int, smallint, tinyint, image 제외한 bit, binary, varbinary 수행</p>
</li>
<li>
<p>시스템 테이블의 정보값을 관리하는데 쓰인다.( 0001 autoclose, 0100 sp_dboption) OR연산으로 시스템 정보 설정</p>
</li>
</ul>
<ol start="2">
<li>논리연산자</li>
</ol>
<ul>
<li>
<p>ALL : 비교하는 모든 값이 참일때 참이 된다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">WHERE ID(1,7,9) ANY(SELECT ID FROM TestTemp - 4,6,8) -9</code></pre></div>
</li>
<li>
<p>ANY, SOME : 비교하려는 값들 중 하나만 참이라도 참이 된다. SOME( ISO 표준 동의어 )</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">WHERE ID(1,7,9) ANY(SELECT ID FROM TestTemp - 4,6,8) -7,9</code></pre></div>
</li>
<li>
<p>EXISTS(서브 질의에 데이터 존재하면 참), IN(나열된 값들 중 하나만 일치하면 참이된다.)</p>
<p>IF EXISTS(SELECT * FROM SALES WHERE stor_id = ‘6380’)</p>
<p>WHERE state IN(‘CA’, ‘IN’, ‘MD’)</p>
</li>
</ul>
</li>
</ul>
<h1 id="고급쿼리" style="position:relative;"><a href="#%EA%B3%A0%EA%B8%89%EC%BF%BC%EB%A6%AC" aria-label="고급쿼리 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>고급쿼리</h1>
<ul>
<li>CASE 함수</li>
</ul>
<ul>
<li>조건 목록을 평가하고 여러 결과 식 중 하나를 반환</li>
</ul>
<ol>
<li>단순 CASE 함수( 단순 식과 비교)</li>
</ol>
<p>SELECT au_fname, au_lname</p>
<p>CASE state</p>
<p>WHEN ‘CA’ THEN ‘Califonia</p>
<p>END AS StateName</p>
<p>FROM authors</p>
<ol start="2">
<li>검색된 CASE 함수</li>
</ol>
<p>SELECT title_id, CAST(title AS varchar(20)) AS title, price,
PriceCategory =
CASE
WHEN price IS NULL THEN N’미정’
WHEN price &#x3C; 10 THEN N’저가’
WHEN price >= 10 AND price &#x3C; 20 THEN N’중가’
ELSE N’고가’
END<br>
FROM titles
ORDER BY price</p>
<ul>
<li>
<p>상관 하위 쿼리를 사용한 CASE 함수</p>
<p>● 외부쿼리 : 서브(내부) 쿼리를 포함한 쿼리 / 내부쿼리(서브쿼리, 하위쿼리) : 쿼리 안의 쿼리</p>
<ul>
<li>외부 쿼리에 영향을 받아 하위 쿼리가 수행되는 것</li>
</ul>
</li>
</ul>
<p>SELECT stor_id, stor_name,</p>
<p>CASE WHEN (SELECT COUNT(*) From Sales WHERE stor_id = s.stor_id) 3 THEN N’활성’</p>
<p>ELSE ‘비활성’</p>
<p>END AS 상태</p>
<p>FROM Stores s</p>
<ul>
<li>
<p>하위쿼리</p>
<ul>
<li>
<p>SELECT, INSERT, UPDATE, DELETE 문이나 다른 하위 쿼리 내부에 중첩된 SELECT 쿼리(최대 32개 중첩이 가능)</p>
</li>
<li>
<p>SELECT : 하나의 값으로 반환해서 표현</p>
<p>WHERE : 하나의 열이나 행 집합(EXISTS, IN, ANY, ALL 논리연산자 이용)</p>
<p>FROM : 여러 열이나 표현식으로 여러 행이 올수 있음(파생테이블)</p>
</li>
</ul>
<ol>
<li>하위쿼리 제한조건</li>
</ol>
<p>하위 쿼리는 TOP 절이 있는 경우에만 ORDER BY 절을 포함할 수 있습니다</p>
<ol start="2">
<li>반복적으로 재계산하여 사용하는 경우는 먼저 계산값을 재사용함.</li>
</ol>
<p>DECLARE @SumQty int</p>
<p>SELECT @SumQty = SUM(qty) FROM Sales</p>
<p>SELECT stor_id, Qty, @SumQty FROM Sales</p>
<ol start="3">
<li>IN을 사용한 하위쿼리 ( 조인으로 처리가능)</li>
</ol>
<p>SELECT title_id, title, pub_id, price</p>
<p>FROM titles</p>
<p>WHERE title_id IN( SELECT title_id FROM Sales WHERE qty>40)</p>
<p>=</p>
<p>SELECT titles.title_id, title, pub_id, price</p>
<p>FROM titles INNER JOIN Sales</p>
<p>ON titles.title_id = Sales.title_id AND qty>40</p>
<ol start="4">
<li>하위 쿼리로 차집합 구하기(NOT IN 구문 이용)</li>
</ol>
<p>SELECT title_id, title FROM titles</p>
<p>WHERE title_id NOT IN( SELECT title_id FROM Sales)</p>
<ol start="5">
<li>EXISTS 사용</li>
</ol>
<p>SELECT DISTINCT pub_name
FROM publishers
WHERE EXISTS
( SELECT * FROM titles
WHERE pub_id = publishers.pub_id
AND type=‘business’)</p>
</li>
</ul>
<p>= IN사용</p>
<p>SELECT DISTINCT pub_name
FROM publishers
WHERE pub_id IN
( SELECT pub_id FROM titles WHERE type=‘business’ )</p>
<ul>
<li>
<p>파생테이블</p>
<ul>
<li>FROM 절에 사용하는 하위 쿼리를 말함.</li>
</ul>
</li>
</ul>
<p>SELECT s.stor_id, stor_name, SumQty
FROM stores t, (SELECT stor_id, SUM(qty) AS SumQty
FROM sales
GROUP BY stor_id ) AS s
WHERE t.stor_id = s.stor_id</p>
<p>SELECT s.stor_id, stor_name, SUM(qty) AS SumQty
FROM stores t, sales s
WHERE t.stor_id = s.stor_id
GROUP BY s.stor_id, stor_name</p>
<ul>
<li>부분 범위 조회</li>
</ul>
<ul>
<li>
<p>TOP 명령어를 이용한 부분 범위를 설정가능함.</p>
</li>
<li>
<p>저장프로시저 : 쿼리문의 집합으로 어떠한 동작을 일괄처리하기 위한 용도로 사용된다.</p>
</li>
</ul>
<p>CREATE PROCEDURE up_GetOrders
@Move nchar(1) = N’F’,
@OrderID int = NULL
AS
IF @Move = N’F’
SELECT TOP 10 * FROM Orders
ORDER BY OrderID DESC</p>
<p>IF @Move = N’L’
SELECT _
FROM ( SELECT TOP 10 _ FROM Orders
ORDER BY OrderID ASC) t
ORDER BY OrderID DESC</p>
<p>=EXEC up_GetOrders ‘L’</p>
<ul>
<li>상관하위쿼리</li>
</ul>
<p>SELECT so.* FROM Sales so</p>
<p>WHERE so.SaleQty = ( SELECT MAX(si.SaleQty) FROM Sales si</p>
<p>WHERE so.ProductID = si.ProductID)</p>
<ul>
<li>동적쿼리 : 동적으로 쿼리 문자열을 만들고 EXECUTE 문으로 실행할 수 있다.</li>
</ul>
<p>장점 : 쿼리의 재사용의 효율을 높여서 DB 성능을 높인다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">       복잡한 쿼리, 자주사용하는 쿼리를 단순화해서 사용할 수 있다.</code></pre></div>
<ul>
<li>STR : 소수점 이하는 절삭하고 10자리 문자열로 만들어준다.</li>
</ul>
<p>CREATE PROC Sales_TopN
@CNT AS int
AS
DECLARE @Str VARCHAR(100)
SELECT @Str = ‘SELECT TOP ’ + STR(@CNT) + ‘Stor_id, Qty FROM Sales ORDER BY Qty DESC’
EXEC(@Str)</p>
<p>EXEC Sales_TopN 10</p>
<ul>
<li>COMPUTE BY</li>
</ul>
<ol>
<li>COMPUTE와 GROUP BY의 차이를 요약</li>
</ol>
<p>GROUP BY는 단일 결과 집합을 반환합니다. 각 그룹별로 그룹화 열과 해당 그룹의 하위 집계를 보여 주는 집계 함수가 포함된 하나의 행이 있습니다. SELECT 목록에는 그룹화 열과 집계 함수만 포함될 수 있습니다. 원시데이터를 보여주지 않음.
COMPUTE (BY)는 원시데이터를 보여주고, 원시데이터와 함꼐 소계와 총계를 조회할 때 많이 쓰인다.
COMPUTE BY 절의 컬럼들은 ORDER BY 절에 명시되어 있어야함.
SELECT stor_id, ord_num, title_id, payterms, qty
FROM sales
WHERE stor_id LIKE ‘706%’
ORDER BY stor_id, qty DESC
COMPUTE AVG(qty), SUM(qty) BY stor_id</p>
<p>COMPUTE AVG(qty), SUM(qty)</p>
<p>SELECT qty, AVG(qty), SUM(qty)
FROM sales
WHERE stor_id LIKE ‘706%’
GROUP BY qty
ORDER BY qty</p>
<h1 id="인덱스-디자인과-사용" style="position:relative;"><a href="#%EC%9D%B8%EB%8D%B1%EC%8A%A4-%EB%94%94%EC%9E%90%EC%9D%B8%EA%B3%BC-%EC%82%AC%EC%9A%A9" aria-label="인덱스 디자인과 사용 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>인덱스 디자인과 사용</h1>
<ul>
<li>용어정리</li>
</ul>
<ul>
<li>
<p>인덱스페이지 : 실제 인덱스가 저장되어 있는 페이지</p>
</li>
<li>
<p>데이터페이지 : 실제 데이터가 저장된 페이지</p>
</li>
<li>
<p>쿼버드 쿼리(Covered Query) : 조회 컬럼과 조건 컬럼을 복합키로 클러스터되지 않은 인덱스로 만든 것</p>
</li>
</ul>
<ul>
<li>인덱스</li>
</ul>
<ul>
<li>쿼리의 응답속도 향상시키기 위해서 사용됨</li>
</ul>
<ul>
<li>인덱스 사용하는 이유</li>
</ul>
<ul>
<li>
<p>주로 자료의 조회뿐만 아니라, 검색 조건을 가진 갱신에 대해서도 수행속도를 높임</p>
</li>
<li>
<p>유일성을 강화하여 중복자료 발생을 막기 위해서 사용됨.</p>
</li>
</ul>
<ul>
<li>인덱스의 단점</li>
</ul>
<ul>
<li>
<p>인덱스는 별도의 저장 공간이 더 필요하며, 인덱스가 많은 경우 데이터를 삽입, 업데이트, 삭제 명령어를 수행할 때 시간이 더 걸린다.</p>
</li>
<li>
<p>또한 유지, 관리하기 위한 처리시간이 더 필요하다.</p>
</li>
</ul>
<ul>
<li>클러스터된 인덱스</li>
</ul>
<ul>
<li>
<p>키 값을 기준으로 테이블에 데이터 행을 정렬하고 저장하는 인덱스, 한 페이지 내의 데이터는 인덱스 키를 기준으로 정렬됨</p>
</li>
<li>
<p>많은 자료 중 하나의 자료를 얻는 것, 데이터 자체가 정렬되어 있기 때문에 범위 검색이 더 효율적으로 사용된다.</p>
</li>
<li>
<p>데이터의 저장소와 인덱스의 저장소가 같이 존재하는 경우이며 데이터는 인덱스의 순서대로 저장하게 된다.</p>
</li>
</ul>
<ul>
<li>클러스터 되지 않은 인덱스</li>
</ul>
<ul>
<li>
<p>데이터의 저장소와 인덱스의 저장소가 별도의 공간으로 분리되어 있으면서 데이터 저장소에 있는 행을 찾아 갈 수 있는 포인터를 갖는</p>
<p>인덱스</p>
</li>
<li>
<p>클러스터 인덱스가 존재하지 않은 경우 RID(행식별자) 포인터로 가지며, 클러스터된 인덱스가 존재하는 경우 클러스터된 인덱스 키 값을</p>
<p>포인터로 갖음.</p>
</li>
</ul>
<ul>
<li>인덱스 디자인</li>
</ul>
<p>● 인덱스가 유용한 경우</p>
<ul>
<li>
<p>특정 검색 키 값과 정확히 일치하는 행을 검색하는 경우(WHERE emp_id = 357)</p>
</li>
<li>
<p>특정 범위에 있는 검색 키 값을 가진 행을 검색하는 경우(WHERE job_lvl BETWEEN 9 and 12)</p>
</li>
<li>
<p>조인 조건자를 기준으로 테이블 T2행과 일치하는 테이블 T1의 행을 검색하는 경우</p>
</li>
<li>
<p>특정 컬럼을 기준으로 정렬된 쿼리 출력을 만드는 경우(ORDER BY Qty DESC)</p>
</li>
<li>
<p>유일성 강화하기 위해 PRIMARY KEY 및 UNIQUE 제약 조건을 보장하는 경우</p>
</li>
<li>
<p>FOREIGN KEY 제약 조건이 정의되는 두 테이블 사이의 참조 무결성을 보장하는 경우</p>
</li>
</ul>
<p>● 인덱스가 유용하지 않은 경우</p>
<ul>
<li>
<p>서로 다른 값이 적은 컬럼 : 성별과 같이 유일자가 작은 경우</p>
</li>
<li>
<p>긴 문자열 데이터형 컬럼( 한페이지에 넣을 수 있는 인덱스의 한계가 있으므로)</p>
</li>
<li>
<p>검색 대상이 자주 사용되지 않은 컬럼</p>
</li>
<li>
<p>bit, text, ntext, image 데이터 형에는 인덱스를 생성할 수 없음</p>
</li>
<li>
<p>작은 테이블에서 인덱스 사용X(테이블 스캔보다 인덱스 통화 시간이 더 길어질 수 있으므로)</p>
</li>
</ul>
<p>● 인덱스 디자인을 위한 추가지침</p>
<ul>
<li>
<p>테이블의 데이터가 변경되면 인덱스도 모두 조정되야 하므로 테이블에 인덱스를 많이 만들면 INSERT, UPDATE, DELETE 성능이</p>
<p>나빠진다</p>
</li>
<li>
<p>SELECT 문과 같이 데이터를 수정하지 않은 쿼리에 대해서는 성능이 좋아진다.</p>
</li>
</ul>
<ul>
<li>
<p>데이터 및 인덱스 저장 구조</p>
<p>● 클러스터된 인덱스를 갖고 있는 클러스터된 테이블</p>
<ul>
<li>데이터 행은 클러스터된 인덱스 키에 기반한 순서대로 저장된다.</li>
</ul>
<p>● 클러스터된 인덱스가 없는 테이블(힙)</p>
<ul>
<li>특정 순서로 저장되지 않으며 데이터 페이지 시퀀스에 대한 특별한 순서는 없다.</li>
</ul>
<p>● 인덱스 ID(sysindexes에서 확인가능)</p>
<ul>
<li>
<p>클러스터된 인덱스가 존재하지 않은 테이블에 대해서는 indid 값 : 0</p>
</li>
<li>
<p>클러스터된 인덱스 indid값 : 1</p>
</li>
<li>
<p>클러스터되지 않은 인덱스 indid값 : 2~250</p>
</li>
<li>
<p>text, ntext, image 열이 있는 테이블 : 255</p>
</li>
</ul>
<p>● Root와 FirstIAM</p>
<ul>
<li>
<p>sysindexes의 root 컬럼은 인덱스 B-트리의 맨위를 가리킨다.</p>
<p>FirstIAM -IAM(테이블의 데이터 페이지 컬렉션) -데이터행 헤더</p>
</li>
</ul>
</li>
<li>
<p>데이터를 검색하는 여러가지 방법</p>
<p>● 테이블 스캔 : 클러스터된 인덱스가 존재하지 않은 테이블에서 IAM 페이지 체인을 이용하여 테이블의 모든 페이지를 I/O 작업</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                    FirstIAM -IAM 페이지 체인의 시작포인터를 통해서 자료가 있는 모든 페이지를 가져옴</code></pre></div>
</li>
</ul>
<p>SELECT _ FROM OrderX
SELECT _ FROM Orders</p>
<p>● IAM을 사용하는 클러스터된 인덱스 스캔</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - 클러스터된 인덱스 전체를 스캔할 때 클러스터된 인덱스의 중간수준 인덱스를 사용하지 않고 IAM을 통해 클러스터된 인덱스 잎

   노드, 즉 모든 데이터 페이지를 I/O하여 작업한다.</code></pre></div>
<p>● 이전 이후 페이지 포인터로 클러스터된 인덱스</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - 클러스터된 인덱스에서는 데이터 페이지 내에 이전 이후 페이지 포인터를 통해 첫페이지나 마지막 페이지에서부터 순차적으로

   전체페이지를 IO한다.( 이전과 다음 페이지 포인터를 통해서 조회)

 - 클러스터 인덱스 : 클러스터 인덱스 키 값을 사용(데이터페이지 공존), 클러스터 되지 않은 인덱스 : 인덱스 페이지를 이용해서

                              데이터페이지를 찾음</code></pre></div>
<p>SELECT * FROM Orders ORDER BY OrderID
SELECT OrderID FROM Orders ORDER BY OrderID DESC</p>
<p>● 클러스터되지 않은 인덱스 스캔</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - 인덱스 검색을 사용하지 않고 인덱스 페이지만을 스캔하여 처리할 수 있는 경우</code></pre></div>
<p>SELECT COUNT(*) FROM Orders</p>
<p>● 클러스터 된 인덱스 검색</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> -  인덱스 루트 노드로부터 B-Tree 검색을 수행하여 결과를 얻음</code></pre></div>
<p>SELECT _ FROM OrderX
SELECT _ FROM Orders</p>
<p>● 클러스터되지 않은 인덱스 검색</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - B-Tree 검색을 수행하면서 인덱스의 키나 행 식별자를 가지고 책갈피 연산을 수행함.</code></pre></div>
<p>SE Northwind</p>
<p>SELECT * INTO OrderX FROM Orders</p>
<p>CREATE INDEX OrderX_OrderDate
ON OrderX(OrderDate)</p>
<p>CREATE INDEX Orders_OD_C
ON Orders(OrderDate, CustomerID)
GO</p>
<p>EXEC sp_helpindex OrderX
EXEC sp_helpindex Orders
GO</p>
<ul>
<li>인덱스 디자인</li>
</ul>
<p>● 인덱스가 유용한 경우</p>
<ul>
<li>
<p>특정 검색 키 값과 정확히 일치하는 행을 검색하는 경우(WHERE emp_id = 357)</p>
</li>
<li>
<p>특정 범위에 있는 검색 키 값을 가진 행을 검색하는 경우(WHERE job_lvl BETWEEN 9 and 12)</p>
</li>
<li>
<p>조인 조건자를 기준으로 테이블 T2행과 일치하는 테이블 T1의 행을 검색하는 경우</p>
</li>
<li>
<p>특정 컬럼을 기준으로 정렬된 쿼리 출력을 만드는 경우(ORDER BY Qty DESC)</p>
</li>
<li>
<p>유일성 강화하기 위해 PRIMARY KEY 및 UNIQUE 제약 조건을 보장하는 경우</p>
</li>
<li>
<p>FOREIGN KEY 제약 조건이 정의되는 두 테이블 사이의 참조 무결성을 보장하는 경우</p>
</li>
</ul>
<p>● 인덱스가 유용하지 않은 경우</p>
<ul>
<li>
<p>서로 다른 값이 적은 컬럼 : 성별과 같이 유일자가 작은 경우</p>
</li>
<li>
<p>긴 문자열 데이터형 컬럼( 한페이지에 넣을 수 있는 인덱스의 한계가 있으므로)</p>
</li>
<li>
<p>검색 대상이 자주 사용되지 않은 컬럼</p>
</li>
<li>
<p>bit, text, ntext, image 데이터 형에는 인덱스를 생성할 수 없음</p>
</li>
<li>
<p>작은 테이블에서 인덱스 사용X(테이블 스캔보다 인덱스 통화 시간이 더 길어질 수 있으므로)</p>
</li>
</ul>
<p>● 인덱스 디자인을 위한 추가지침</p>
<ul>
<li>
<p>테이블의 데이터가 변경되면 인덱스도 모두 조정되야 하므로 테이블에 인덱스를 많이 만들면 INSERT, UPDATE, DELETE 성능이</p>
<p>나빠진다</p>
</li>
<li>
<p>SELECT 문과 같이 데이터를 수정하지 않은 쿼리에 대해서는 성능이 좋아진다.</p>
</li>
</ul>
<ul>
<li>
<p>데이터 및 인덱스 저장 구조</p>
<p>● 클러스터된 인덱스를 갖고 있는 클러스터된 테이블</p>
<ul>
<li>데이터 행은 클러스터된 인덱스 키에 기반한 순서대로 저장된다.</li>
</ul>
<p>● 클러스터된 인덱스가 없는 테이블(힙)</p>
<ul>
<li>특정 순서로 저장되지 않으며 데이터 페이지 시퀀스에 대한 특별한 순서는 없다.</li>
</ul>
<p>● 인덱스 ID(sysindexes에서 확인가능)</p>
<ul>
<li>
<p>클러스터된 인덱스가 존재하지 않은 테이블에 대해서는 indid 값 : 0</p>
</li>
<li>
<p>클러스터된 인덱스 indid값 : 1</p>
</li>
<li>
<p>클러스터되지 않은 인덱스 indid값 : 2~250</p>
</li>
<li>
<p>text, ntext, image 열이 있는 테이블 : 255</p>
</li>
</ul>
<p>● Root와 FirstIAM</p>
<ul>
<li>
<p>sysindexes의 root 컬럼은 인덱스 B-트리의 맨위를 가리킨다.</p>
<p>FirstIAM -IAM(테이블의 데이터 페이지 컬렉션) -데이터행 헤더</p>
</li>
</ul>
</li>
<li>
<p>데이터를 검색하는 여러가지 방법</p>
<p>● 테이블 스캔 : 클러스터된 인덱스가 존재하지 않은 테이블에서 IAM 페이지 체인을 이용하여 테이블의 모든 페이지를 I/O 작업</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                    FirstIAM -IAM 페이지 체인의 시작포인터를 통해서 자료가 있는 모든 페이지를 가져옴</code></pre></div>
</li>
</ul>
<p>SELECT _ FROM OrderX
SELECT _ FROM Orders</p>
<p>● IAM을 사용하는 클러스터된 인덱스 스캔</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - 클러스터된 인덱스 전체를 스캔할 때 클러스터된 인덱스의 중간수준 인덱스를 사용하지 않고 IAM을 통해 클러스터된 인덱스 잎

   노드, 즉 모든 데이터 페이지를 I/O하여 작업한다.</code></pre></div>
<p>● 이전 이후 페이지 포인터로 클러스터된 인덱스</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - 클러스터된 인덱스에서는 데이터 페이지 내에 이전 이후 페이지 포인터를 통해 첫페이지나 마지막 페이지에서부터 순차적으로

   전체페이지를 IO한다.( 이전과 다음 페이지 포인터를 통해서 조회)

 - 클러스터 인덱스 : 클러스터 인덱스 키 값을 사용(데이터페이지 공존), 클러스터 되지 않은 인덱스 : 인덱스 페이지를 이용해서

                              데이터페이지를 찾음</code></pre></div>
<p>SELECT * FROM Orders ORDER BY OrderID
SELECT OrderID FROM Orders ORDER BY OrderID DESC</p>
<p>● 클러스터되지 않은 인덱스 스캔</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - 인덱스 검색을 사용하지 않고 인덱스 페이지만을 스캔하여 처리할 수 있는 경우</code></pre></div>
<p>SELECT COUNT(*) FROM Orders</p>
<p>● 클러스터 된 인덱스 검색</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> -  인덱스 루트 노드로부터 B-Tree 검색을 수행하여 결과를 얻음</code></pre></div>
<p>SELECT _ FROM OrderX
SELECT _ FROM Orders</p>
<p>● 클러스터되지 않은 인덱스 검색</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> - B-Tree 검색을 수행하면서 인덱스의 키나 행 식별자를 가지고 책갈피 연산을 수행함.</code></pre></div>
<p>SE Northwind</p>
<p>SELECT * INTO OrderX FROM Orders</p>
<p>CREATE INDEX OrderX_OrderDate
ON OrderX(OrderDate)</p>
<p>CREATE INDEX Orders_OD_C
ON Orders(OrderDate, CustomerID)
GO</p>
<p>EXEC sp_helpindex OrderX
EXEC sp_helpindex Orders
GO</p>
<ul>
<li>인덱스를 사용하지 않은 가능성이 높은 쿼리문</li>
</ul>
<ol>
<li>부정 검색 조건에서의 인덱스 사용</li>
</ol>
<p>SELECT * FROM orders WHERE OrderDate &#x3C;‘19960704’</p>
<ol start="2">
<li>인덱스 컬럼 변형에 대한 검색</li>
</ol>
<p>SELECT * FROM orders WHERE CONVERT(char(5), OrderID) LIKE ‘1024%’</p>
<ol start="3">
<li>데이터형이 맞지 않는 검색조건</li>
</ol>
<p>CREATE TABLE TestOrders
(OrderID char(5) NOT NULL,
…</p>
<p>SELECT * FROM TestOrders WHERE OrderID = 10500</p>
<ol start="4">
<li>패턴 조건 검색에서 인덱스 사용</li>
</ol>
<p>SELECT * FROM TestOrder WHERE OrderID LIKE ‘%500’</p>
<ul>
<li>인덱스 생성 옵션</li>
</ul>
<p>CREATE NONCLUSTERED INDEX zip_ind</p>
<p>ON authors(zip)</p>
<p>WITH FILLFACTOR = 70 -70 FILLFACTOR 채워서 30% 빈공간을 만듦</p>
<p>● FILLFACTOR - 인덱스 페이지를 어느정도 압축하거나 비워 놓을 것인가를 설정할 수 있는 옵션,</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                       잎 노드의 인덱스 페이지를 명시한 % 만큼 사용하고 나머지는 비우게 된다.

                  -인덱스 페이지 공간이 부족하다면 새로운 페이지를 할당받아야 하므로 이런 페이지 분할 작업을 줄이기 위해서 사용됨</code></pre></div>
<p>● PAD_INDEX : 인덱스 잎 페이지 외에 나머지 인덱스 페이지들의 수준을 FILLFACTOR 명시한 수준으로 바꿈</p>
<p>● IGNORE_DUP_KEY :</p>
<p>-INSERT 작업으로 중복 자료가 입력되는 것에 대해 오류 대신 경고로 처리, UPDATE 작업으로 중복이 발생되는 것은 오류로 처리한다.
USE tempdb
GO</p>
<p>CREATE TABLE emp_pay
(employeeID int NOT NULL
,base_pay money NOT NULL
,commision decimal(2,2) NOT NULL)
GO</p>
<p>CREATE UNIQUE CLUSTERED INDEX employeeID_ind
ON emp_pay(employeeID)
WITH IGNORE_DUP_KEY
GO</p>
<p>INSERT emp_pay VALUES(1, 500, .10) -가능(중복된 키값이라도 가능)
INSERT emp_pay VALUES(1, 1000, .05)
GO</p>
<p>SET NOCOUNT ON</p>
<p>INSERT emp_pay VALUES(5,0,.03)
SELECT @@ERROR
GO</p>
<p>UPDATE emp_pay SET employeeID = 1 WHERE base_pay = 500
SELECT @@ERROR
GO</p>
<p>SELECT * FROM emp_pay</p>
<p>=결과</p>
<p>메시지 2601, 수준 14, 상태 1, 줄 2
고유 인덱스가 ‘employeeID_ind’인 개체 ‘dbo.emp_pay’에 중복 키 행을 삽입할 수 없습니다. 중복 키 값은 (1)입니다.</p>
<p>● DROP_EXISTING / STATISTICS_NORECOMPUTE / SORT_IN_TEMPDB</p>
<ul>
<li>
<p>DBCC SHOWCONTIG</p>
<ul>
<li>
<p>테이블의 조각화 여부를 파악하는데 사용한다. 테이블의 조각화는 테이블에서 INSERT, UPDATE,DELETE 문 등의 데이터 수정 문을</p>
<p>처리할 때 발생한다.</p>
</li>
</ul>
</li>
<li>
<p>DBCC INDEXDEFRAG</p>
<ul>
<li>인덱스의 잎 수준 페이지를 논리적순서로 다시 정렬한다.</li>
</ul>
</li>
<li>
<p>DBCC DBREINDEX</p>
<ul>
<li>테이블의 특정 인덱스나 테이블에 정의도니 모든 인덱스를 다시 작성한다.</li>
</ul>
</li>
</ul></article><section class="PostContent__PostNavigator-sc-9jovib-6 epVIUP"><a href="/blog/2020/02/2020-02-16-winapi/"><h5>이전글</h5><i>← </i>Windows API</a><a href="/blog/2020/01/2020-01-01-pdf/"><h5>다음글</h5>pdf<i> →</i></a></section><div></div></div><aside class="PostContent__TocRenderer-sc-9jovib-4 bnGTbM"><ul>
<li>
<p><a href="#%EC%9A%A9%EC%96%B4%EC%A0%95%EB%A6%AC">용어정리</a></p>
</li>
<li>
<p><a href="#sql-server-%EA%B0%9C%EC%9A%94">SQL Server 개요</a></p>
</li>
<li>
<p><a href="#transact-sql-%EA%B8%B0%EC%B4%88">Transact-SQL 기초</a></p>
<ul>
<li><a href="#deptno">DEPTNO</a></li>
</ul>
</li>
<li>
<p><a href="#db-%EC%83%9D%EC%84%B1%EA%B3%BC-%EA%B4%80%EB%A6%AC">DB 생성과 관리</a></p>
</li>
<li>
<p><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%98%95%EC%8B%9D-%EB%B0%8F-%ED%98%95%EB%B3%80%ED%99%98">데이터형식 및 형변환</a></p>
</li>
<li>
<p><a href="#%ED%85%8C%EC%9D%B4%EB%B8%94%EA%B3%BC-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%EC%83%9D%EC%84%B1%EA%B3%BC-%EC%82%AC%EC%9A%A9">테이블과 제약 조건 생성과 사용</a></p>
</li>
<li>
<p><a href="#%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%A7%80%EC%9B%90-%ED%95%A8%EC%88%98-%EB%B0%8F-%EC%97%B0%EC%82%B0%EC%9E%90">시스템 지원 함수 및 연산자</a></p>
</li>
<li>
<p><a href="#%EA%B3%A0%EA%B8%89%EC%BF%BC%EB%A6%AC">고급쿼리</a></p>
</li>
<li>
<p><a href="#%EC%9D%B8%EB%8D%B1%EC%8A%A4-%EB%94%94%EC%9E%90%EC%9D%B8%EA%B3%BC-%EC%82%AC%EC%9A%A9">인덱스 디자인과 사용</a></p>
</li>
</ul></aside></div><div class="Footer__FooterWrapper-sc-rphy7j-0 cAuPRp">Thank You for Visiting My Blog,<br/>© 2021 Developer SeungAh, Powered By Gatsby.</div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2020/02/2020-02-14-mssql/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-f5859ebadfae58c80416.js\"],\"component---src-components-templates-post-template-tsx\":[\"/component---src-components-templates-post-template-tsx-42527037c88e36973702.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-93dcd87a0d7b609482e2.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-ed4d3b150f6b0138dbea.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-94b0bc5fd2db0bc7eebb.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="bb720f25781dde3191bb";</script><script src="/webpack-runtime-8dbd70267d4788f4e48e.js" async></script><script src="/framework-cec49bf0003519f52199.js" async></script><script src="/app-f5859ebadfae58c80416.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>