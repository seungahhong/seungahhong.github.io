{"componentChunkName":"component---src-components-templates-post-template-tsx","path":"/blog/2023/06/2023-06-30-react-query-v4/","result":{"data":{"site":{"siteMetadata":{"title":"홍승아 기술 블로그","description":"홍승아 기술 블로그에 오신걸 환영합니다.","author":"홍승아","type":"website","siteUrl":"https://seungahhong.github.io","social":{"facebook":"https://www.facebook.com/people/%ED%99%8D%EC%8A%B9%EC%95%84/100002349562000/","github":"https://github.com/seungahhong","notion":"https://material-debt-c1c.notion.site/daa60481e37840ea9e1b7e1b12269942","linkedin":"https://www.linkedin.com/in/seungahhong/"}}},"allFile":{"edges":[{"node":{"name":"facebook","publicURL":"/static/b185e9b61bb465d92b14ed1c9a9ded61/facebook.svg","childImageSharp":null}},{"node":{"name":"github","publicURL":"/static/4a6687a74051de2b3536e95d0b6c992a/github.svg","childImageSharp":null}},{"node":{"name":"linkedin","publicURL":"/static/3dc9e0d0f748678205218f1c72941cc2/linkedin.svg","childImageSharp":null}},{"node":{"name":"notion","publicURL":"/static/19b0f81386812ed2f2f3a7aea202935f/notion.svg","childImageSharp":null}},{"node":{"name":"background","publicURL":"/static/77f5c833c2343c992fd263c780495905/background.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,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"},"images":{"fallback":{"src":"/static/77f5c833c2343c992fd263c780495905/c2a83/background.jpg","srcSet":"/static/77f5c833c2343c992fd263c780495905/9330e/background.jpg 139w,\n/static/77f5c833c2343c992fd263c780495905/53b4d/background.jpg 278w,\n/static/77f5c833c2343c992fd263c780495905/c2a83/background.jpg 555w","sizes":"(min-width: 555px) 555px, 100vw"},"sources":[{"srcSet":"/static/77f5c833c2343c992fd263c780495905/3ee68/background.webp 139w,\n/static/77f5c833c2343c992fd263c780495905/d0ff1/background.webp 278w,\n/static/77f5c833c2343c992fd263c780495905/21b9c/background.webp 555w","type":"image/webp","sizes":"(min-width: 555px) 555px, 100vw"}]},"width":555,"height":961}}}}]},"allMarkdownRemark":{"edges":[{"node":{"html":"<h1 id=\"install\" style=\"position:relative;\"><a href=\"#install\" aria-label=\"install permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install</h1>\n<h2 id=\"react-quey--tanstackreact-query로-변경\" style=\"position:relative;\"><a href=\"#react-quey--tanstackreact-query%EB%A1%9C-%EB%B3%80%EA%B2%BD\" aria-label=\"react quey  tanstackreact query로 변경 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>react-quey → @tanstack/react-query로 변경</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> uninstall react-query\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> @tanstack/react-query\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> @tanstack/react-query-devtools</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// v3</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-query'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ReactQueryDevtools <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-query/devtools'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> QueryClientProvider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-query/react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// v4</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tanstack/react-query'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ReactQueryDevtools <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tanstack/react-query-devtools'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> QueryClientProvider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tanstack/react-query/reactjs'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"지원범위\" style=\"position:relative;\"><a href=\"#%EC%A7%80%EC%9B%90%EB%B2%94%EC%9C%84\" aria-label=\"지원범위 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>지원범위</h1>\n<ul>\n<li>\n<p>typescript</p>\n<ul>\n<li>TypeScript v4.1 or greater</li>\n</ul>\n</li>\n<li>\n<p>Supported Browsers</p>\n<ul>\n<li>v4부터 React Query는 최신 브라우저에 최적화</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">Chrome <span class=\"token operator\">>=</span> <span class=\"token number\">73</span><span class=\"token punctuation\">;</span>\nFirefox <span class=\"token operator\">>=</span> <span class=\"token number\">78</span><span class=\"token punctuation\">;</span>\nEdge <span class=\"token operator\">>=</span> <span class=\"token number\">79</span><span class=\"token punctuation\">;</span>\nSafari <span class=\"token operator\">>=</span> <span class=\"token number\">12.0</span><span class=\"token punctuation\">;</span>\niOS <span class=\"token operator\">>=</span> <span class=\"token number\">12.0</span><span class=\"token punctuation\">;</span>\nopera <span class=\"token operator\">>=</span> <span class=\"token number\">53</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>Support for React 18</li>\n</ul>\n<h1 id=\"v3--v4-migraion-toolscodemod\" style=\"position:relative;\"><a href=\"#v3--v4-migraion-toolscodemod\" aria-label=\"v3  v4 migraion toolscodemod permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>v3 → v4 migraion tools: <strong><a href=\"https://tanstack.com/query/v4/docs/react/guides/migrating-to-react-query-4#codemod\" target=\"_blank\" rel=\"nofollow\">Codemod</a></strong></h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># jsx/js 인 경우</span>\nnpx jscodeshift ./path/to/src/ <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--extensions</span><span class=\"token operator\">=</span>js,jsx <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--transform</span><span class=\"token operator\">=</span>./node_modules/@tanstack/react-query/codemods/v4/replace-import-specifier.js\n\n<span class=\"token comment\"># tsx/ts 인 경우</span>\nnpx jscodeshift ./path/to/src/ <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--extensions</span><span class=\"token operator\">=</span>ts,tsx <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--parser</span><span class=\"token operator\">=</span>tsx <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--transform</span><span class=\"token operator\">=</span>./node_modules/@tanstack/react-query/codemods/v4/replace-import-specifier.js</code></pre></div>\n<h1 id=\"new-features\" style=\"position:relative;\"><a href=\"#new-features\" aria-label=\"new features permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>New Features</h1>\n<h2 id=\"the-idle-state-has-been-removed\" style=\"position:relative;\"><a href=\"#the-idle-state-has-been-removed\" aria-label=\"the idle state has been removed permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The idle state has been removed</h2>\n<ul>\n<li>\n<p>오프라인 지원을 개선하기 위해 새로운 fetchStatus가 도입</p>\n</li>\n<li>\n<p>동일한 상태를 더 잘 캡처하는 fetchStatus: ‘idle’로 인해 idle state는 불필요해짐</p>\n<ul>\n<li>\n<p><strong><code class=\"language-text\">status</code></strong>: <code class=\"language-text\">data</code>, 쿼리 결과값에 대한 정보를 나타냄</p>\n<ul>\n<li>loading: 아직 data가 없음</li>\n<li>error: data는 없고 에러가 있음</li>\n<li>success: data가 있음</li>\n</ul>\n</li>\n<li>\n<p><strong><code class=\"language-text\">fetchStatus</code></strong>: <code class=\"language-text\">queryFn</code>에 대한 정보를 나타냄</p>\n<ul>\n<li>idle: 쿼리가 아무것도 안하고 있는 상태</li>\n<li>paused: 쿼리가 패칭을 시도했지만 일시중지된 상태. network mode와 연관</li>\n<li>fetching: 쿼리가 패칭중인 상태</li>\n</ul>\n</li>\n<li>\n<p>v3에서 background refetch 상황에서는 패칭에 대한 상태값을 isLoading으로 알 수가 없어서 isFetching을 사용</p>\n<ul>\n<li>isFetching 외에 fetchStatus.fetching 사용가능</li>\n<li>status가 query의 상태를 제대로 표현할 수 없었던 것이죠.</li>\n<li>비활성화된 쿼리(사용하지 않는 쿼리)에 대한 초기 상태값이 isLoading 변경</li>\n<li>isLoading → isInitialLoading</li>\n<li>캐시된 데이터가 없는(isLoading) 쿼리를 요청(isFetching)하면 isInitialLoading === true</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> isSuccess<span class=\"token operator\">:</span> q1Succeed <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token operator\">:</span> q2Data<span class=\"token punctuation\">,</span> isLoading<span class=\"token operator\">:</span> q2Loading <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      enabled<span class=\"token operator\">:</span> q1Succeed<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token operator\">:</span> q3Data<span class=\"token punctuation\">,</span> isLoading<span class=\"token operator\">:</span> q3Loading <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      enabled<span class=\"token operator\">:</span> q1Succeed<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> refetch<span class=\"token operator\">:</span> q4Refetch <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      enabled<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>q2Loading <span class=\"token operator\">||</span> q3Loading<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>q2Data<span class=\"token punctuation\">.</span>tmpData<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> / </span><span class=\"token punctuation\">{</span>q3Data<span class=\"token punctuation\">.</span>tmpData<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// useQuery1\tuseQuery2\tuseQuery3\tuseQuery4</span>\n<span class=\"token comment\">// 1\tidle\t  idle\t    idle\t    idle</span>\n<span class=\"token comment\">// 2\tloading\tidle\t    idle\t    idle</span>\n<span class=\"token comment\">// 3\tsuccess\tidle\t    idle\t    idle</span>\n<span class=\"token comment\">// 4\tsuccess\tloading\t  loading\t  idle</span>\n<span class=\"token comment\">// 5\tsuccess\tsuccess\t  success\t  idle</span></code></pre></div>\n<h2 id=\"queries-and-mutations-per-default-need-network-connection-to-run\" style=\"position:relative;\"><a href=\"#queries-and-mutations-per-default-need-network-connection-to-run\" aria-label=\"queries and mutations per default need network connection to run permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Queries and mutations, per default, need network connection to run</h2>\n<ul>\n<li>query와 mutation의 명시적인 오프라인 모드를 제공하는 기능인 networkMode 옵션이 추가</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  defaultOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    queries<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      networkMode<span class=\"token operator\">:</span> <span class=\"token string\">'offlineFirst'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    mutations<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      networkMode<span class=\"token operator\">:</span> <span class=\"token string\">'offlineFirst'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<p>networkMode의 설정값은 3가지입니다.</p>\n<ul>\n<li><strong><code class=\"language-text\">online</code></strong>: 오프라인 상태에서 network connection이 있기 전까지 fetch를 하지 않고, 이때 쿼리의 상태를 <code class=\"language-text\">fetchStatus:paused</code> 로 표시합니다.</li>\n<li><strong><code class=\"language-text\">always</code></strong>: 오프라인 상태에서도 온라인처럼 fetch를 시도합니다. 오프라인 상태에서 요청을 보내는 것이니 <code class=\"language-text\">status:error</code> 상태가 될 겁니다.</li>\n<li><strong><code class=\"language-text\">offlineFirst</code></strong>: v3에서의 동작과 같습니다. queryFn 최초 호출 후 retry를 멈춥니다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"tracked-query-per-default성능개선\" style=\"position:relative;\"><a href=\"#tracked-query-per-default%EC%84%B1%EB%8A%A5%EA%B0%9C%EC%84%A0\" aria-label=\"tracked query per default성능개선 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tracked Query per default(성능개선)</h2>\n<ul>\n<li>\n<p><a href=\"https://github.com/TanStack/query/discussions/1554\" target=\"_blank\" rel=\"nofollow\">Tracked Query</a>: useQuery의 리턴값 중, 실질적으로 직접 접근하는 값들이 변했을때만 리렌더링이 되게끔 하는 최적화 처리</p>\n</li>\n<li>\n<p>v4부터는 이 처리가 없이도 <a href=\"https://github.com/TanStack/query/discussions/1554\" target=\"_blank\" rel=\"nofollow\">자체적으로 query를 proxy처리하고</a>, 컴포넌트에서 어떤 값에 접근하는지 판단하여 해당 값을 렌더링 처리해줌.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// v3</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">,</span> fetchUser<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// notifyOnChangeProps: ['data'], // data가 바뀌었을 때만 리렌더링</span>\n    notifyOnChangeProps<span class=\"token operator\">:</span> <span class=\"token string\">'tracked'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Username: </span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// v4</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// notifyOnChangeProps가 없어도 data가 바뀌었을 때만 리렌더링</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">,</span> fetchUser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Username: </span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h1 id=\"change-features\" style=\"position:relative;\"><a href=\"#change-features\" aria-label=\"change features permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Change Features</h1>\n<h2 id=\"new-api-for-usequeries\" style=\"position:relative;\"><a href=\"#new-api-for-usequeries\" aria-label=\"new api for usequeries permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>new API for useQueries</h2>\n<ul>\n<li>useQueries에 여러개 쿼리를 넘길 때 방식의 변화</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// v3</span>\n<span class=\"token function\">useQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> queryKey1<span class=\"token punctuation\">,</span> queryFn1<span class=\"token punctuation\">,</span> options1 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> queryKey2<span class=\"token punctuation\">,</span> queryFn2<span class=\"token punctuation\">,</span> options2 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// v4</span>\n<span class=\"token function\">useQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  queries<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> queryKey1<span class=\"token punctuation\">,</span> queryFn1<span class=\"token punctuation\">,</span> options1 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> queryKey2<span class=\"token punctuation\">,</span> queryFn2<span class=\"token punctuation\">,</span> options2 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"query-keys-and-mutation-keys-need-to-be-an-array쿼리키는-배열만-가능\" style=\"position:relative;\"><a href=\"#query-keys-and-mutation-keys-need-to-be-an-array%EC%BF%BC%EB%A6%AC%ED%82%A4%EB%8A%94-%EB%B0%B0%EC%97%B4%EB%A7%8C-%EA%B0%80%EB%8A%A5\" aria-label=\"query keys and mutation keys need to be an array쿼리키는 배열만 가능 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Query Keys (and Mutation Keys) need to be an Array(쿼리키는 배열만 가능)</h2>\n<ul>\n<li>\n<p>Query key (혹은 Mutation Key)가 배열로 변경</p>\n</li>\n<li>\n<p>v3에서 key는 String | Array 둘 다 가능했다. 하지만 v4에서는 Array 형태만 가능</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// v3</span>\n<span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">'todos'</span><span class=\"token punctuation\">,</span> fetchTodos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// v4</span>\n<span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'todos'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> fetchTodos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"onsuccess-is-no-loger-called-from-setquerydata\" style=\"position:relative;\"><a href=\"#onsuccess-is-no-loger-called-from-setquerydata\" aria-label=\"onsuccess is no loger called from setquerydata permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>onSuccess is no loger called from setQueryData</h2>\n<ul>\n<li>\n<p>onSuccess 콜백이 setQueryData를 호출했을 때 더이상 호출되지 않습니다.</p>\n</li>\n<li>\n<p>onSuccess 콜백은 실질적인 요청이 발생한 후에만 호출됩니다.</p>\n</li>\n<li>\n<p>data가 바뀐 것을 실질적으로 구독하고 싶다면 onSuccess → useEffect 사용 권고</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> queryKey<span class=\"token punctuation\">,</span> queryFn <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nReact<span class=\"token punctuation\">.</span><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mySideEffectHere</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"undefined-is-an-illegal-cache-value-for-successful-queriesqueryfn-undefined-리턴-불가\" style=\"position:relative;\"><a href=\"#undefined-is-an-illegal-cache-value-for-successful-queriesqueryfn-undefined-%EB%A6%AC%ED%84%B4-%EB%B6%88%EA%B0%80\" aria-label=\"undefined is an illegal cache value for successful queriesqueryfn undefined 리턴 불가 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Undefined is an illegal cache value for successful queries(queryFn undefined 리턴 불가)</h2>\n<p><code class=\"language-text\">queryFn</code>이 <code class=\"language-text\">undefined</code>를 리턴할 수 없도록 타입, 런타임 단에서 막힘</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ❌</span>\n<span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>result <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"the-cancel-method-on-promises-is-no-longer-supported\" style=\"position:relative;\"><a href=\"#the-cancel-method-on-promises-is-no-longer-supported\" aria-label=\"the cancel method on promises is no longer supported permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The cancel method on promises is no longer supported</h2>\n<ul>\n<li>\n<p>query cancellation 지원을 위해서 사용되던 cancel 메서드 사용안됨</p>\n</li>\n<li>\n<p>대신 쿼리 취소를 위해서는 내부적으로 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/AbortController\" target=\"_blank\" rel=\"nofollow\">AbortController API</a>를 사용하고 쿼리 취소를 지원하기 위해 쿼리 함수에 대한 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal\" target=\"_blank\" rel=\"nofollow\">AbortSignal instance</a>를 제공하는 <a href=\"https://tanstack.com/query/v4/docs/react/guides/query-cancellation\" target=\"_blank\" rel=\"nofollow\">newer API</a>(v3.30.0에 도입됨)를 사용을 권고</p>\n</li>\n</ul>\n<h2 id=\"logging-in-production\" style=\"position:relative;\"><a href=\"#logging-in-production\" aria-label=\"logging in production permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logging in production</h2>\n<ul>\n<li>production 모드에서는 로깅 처리 비활성(개발 모드에서는 오류 표시)</li>\n</ul>\n<h2 id=\"setlogger-is-removed\" style=\"position:relative;\"><a href=\"#setlogger-is-removed\" aria-label=\"setlogger is removed permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>setLogger is removed</h2>\n<ul>\n<li>전역으로 세팅했던 로그에 대한 활성화 사용법 변경</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// v3</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> QueryClient<span class=\"token punctuation\">,</span> setLogger <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-query'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setLogger</span><span class=\"token punctuation\">(</span>customLogger<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> queryClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// v4</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> QueryClient <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tanstack/react-query'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> queryClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> logger<span class=\"token operator\">:</span> customLogger <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"react-router-dom-v6-연동\" style=\"position:relative;\"><a href=\"#react-router-dom-v6-%EC%97%B0%EB%8F%99\" aria-label=\"react router dom v6 연동 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>react-router-dom v6 연동</h1>\n<p><a href=\"https://tanstack.com/query/v4/docs/react/examples/react/react-router\" target=\"_blank\" rel=\"nofollow\">https://tanstack.com/query/v4/docs/react/examples/react/react-router</a></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> queryClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  defaultOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    queries<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      staleTime<span class=\"token operator\">:</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token function\">createBrowserRouter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n    element<span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Root</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n    errorElement<span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ErrorPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n    loader<span class=\"token operator\">:</span> <span class=\"token function\">rootLoader</span><span class=\"token punctuation\">(</span>queryClient<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    action<span class=\"token operator\">:</span> <span class=\"token function\">rootAction</span><span class=\"token punctuation\">(</span>queryClient<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"참고페이지\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%ED%8E%98%EC%9D%B4%EC%A7%80\" aria-label=\"참고페이지 permalink\" class=\"custom-class before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고페이지</h1>\n<ul>\n<li><a href=\"https://tanstack.com/query/v4/docs/react/guides/migrating-to-react-query-4\" target=\"_blank\" rel=\"nofollow\">https://tanstack.com/query/v4/docs/react/guides/migrating-to-react-query-4</a></li>\n<li><a href=\"https://nuhends.tistory.com/134\" target=\"_blank\" rel=\"nofollow\">https://nuhends.tistory.com/134</a></li>\n<li><a href=\"https://maxkim-j.github.io/posts/tanstack-query-v4-preview/\" target=\"_blank\" rel=\"nofollow\">https://maxkim-j.github.io/posts/tanstack-query-v4-preview/</a></li>\n</ul>","frontmatter":{"title":"react-query(v4)","date":"2023.06.30","category":"개발","tags":["상태관리"]},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#install\">Install</a></p>\n<ul>\n<li><a href=\"#react-quey--tanstackreact-query%EB%A1%9C-%EB%B3%80%EA%B2%BD\">react-quey → @tanstack/react-query로 변경</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A7%80%EC%9B%90%EB%B2%94%EC%9C%84\">지원범위</a></p>\n</li>\n<li>\n<p><a href=\"#v3--v4-migraion-toolscodemod\">v3 → v4 migraion tools: <strong>Codemod</strong></a></p>\n</li>\n<li>\n<p><a href=\"#new-features\">New Features</a></p>\n<ul>\n<li><a href=\"#the-idle-state-has-been-removed\">The idle state has been removed</a></li>\n<li><a href=\"#queries-and-mutations-per-default-need-network-connection-to-run\">Queries and mutations, per default, need network connection to run</a></li>\n<li><a href=\"#tracked-query-per-default%EC%84%B1%EB%8A%A5%EA%B0%9C%EC%84%A0\">Tracked Query per default(성능개선)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#change-features\">Change Features</a></p>\n<ul>\n<li><a href=\"#new-api-for-usequeries\">new API for useQueries</a></li>\n<li><a href=\"#query-keys-and-mutation-keys-need-to-be-an-array%EC%BF%BC%EB%A6%AC%ED%82%A4%EB%8A%94-%EB%B0%B0%EC%97%B4%EB%A7%8C-%EA%B0%80%EB%8A%A5\">Query Keys (and Mutation Keys) need to be an Array(쿼리키는 배열만 가능)</a></li>\n<li><a href=\"#onsuccess-is-no-loger-called-from-setquerydata\">onSuccess is no loger called from setQueryData</a></li>\n<li><a href=\"#undefined-is-an-illegal-cache-value-for-successful-queriesqueryfn-undefined-%EB%A6%AC%ED%84%B4-%EB%B6%88%EA%B0%80\">Undefined is an illegal cache value for successful queries(queryFn undefined 리턴 불가)</a></li>\n<li><a href=\"#the-cancel-method-on-promises-is-no-longer-supported\">The cancel method on promises is no longer supported</a></li>\n<li><a href=\"#logging-in-production\">Logging in production</a></li>\n<li><a href=\"#setlogger-is-removed\">setLogger is removed</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#react-router-dom-v6-%EC%97%B0%EB%8F%99\">react-router-dom v6 연동</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0%ED%8E%98%EC%9D%B4%EC%A7%80\">참고페이지</a></p>\n</li>\n</ul>"}}]}},"pageContext":{"slug":"/blog/2023/06/2023-06-30-react-query-v4/","previous":{"fields":{"slug":"/blog/2023/07/2023-07-22-zustand/"},"frontmatter":{"title":"zustand"}},"next":{"fields":{"slug":"/blog/2023/04/2023-04-02-playwright/"},"frontmatter":{"title":"Playwright"}}}},"staticQueryHashes":["3940312266","4157816502"],"slicesMap":{}}