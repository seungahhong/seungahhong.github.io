---
layout: post
title: jest
date: 2022-07-24
published: 2022-07-24
category: ê°œë°œ
tags: ['test', 'jest']
comments: true,
thumbnail: './images/24/thumbnail.png'
github: 'https://github.com/seungahhong/seungahhong.github.io'
---

# ê¸°ë³¸ ì‚¬ìš©ë²•

<p style="font-size: 25px; font-weight: bold;">react testing library</p>

- ì„¤ì¹˜

  ```bash
  npm install --save-dev @testing-library/react
  or
  yarn add -D @testing-library/react
  ```

- ì‚¬ìš©í• ë•Œ ì£¼ì˜í• ì 

ì°¸ê³  url

[https://seongry.github.io/2021/06-20-common-mistakes-with-rty/](https://seongry.github.io/2021/06-20-common-mistakes-with-rty/)
[Common mistakes with React Testing Library](https://kentcdodds.com/blog/common-mistakes-with-react-testing-library)

- destructure what you need from render or call it view.

  ```tsx
  // âŒ
  const wrapper = render(<Example prop="1" />);
  wrapper.rerender(<Example prop="2" />);

  // âœ…
  const { rerender } = render(<Example prop="1" />);
  rerender(<Example prop="2" />);
  ```

- automatically Cleanup

  ```tsx
  // âŒ
  import { render, screen, cleanup } from '@testing-library/react';

  afterEach(cleanup);

  // âœ…
  import { render, screen } from '@testing-library/react';
  ```

  ëŒ€ë¶€ë¶„ì˜ ë©”ì´ì € í”„ë ˆì„ì›Œí¬(mocha, Jest, and Jasmine)ì—ì„œ ìë™ì ìœ¼ë¡œ cleanup í•¨ìˆ˜ê°€ í˜¸ì¶œë¨ìœ¼ë¡œ ê° í…ŒìŠ¤íŠ¸ ë§ˆë‹¤ cleanup í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ì¤„ í•„ìš”ê°€ ì—†ë‹¤.

- screenì„ ì‚¬ìš©í•  ê²ƒ

  ```tsx
  // âŒ ì‚¬ìš©í•´ì•¼ í•  ê¸°ëŠ¥ì´ ë§ì•„ ì§ˆ ìˆ˜ ìˆë‹¤.
  const { getByRole } = render(<Example />);
  const errorMessageNode = getByRole('alert');

  // âœ… ì‚¬ìš©í•´ì•¼ í•  ê¸°ëŠ¥ì´ ë§ì•„ì ¸ë„ ì¶”ê°€ë˜ëŠ” ì½”ë“œê°€ ì—†ë‹¤.
  render(<Example />);
  const errorMessageNode = screen.getByRole('alert');

  // debug í•¨ìˆ˜ ëŒ€ì‹ ì— screen.debug í˜¸ì¶œí•´ì£¼ì„¸ìš”..
  screen.debug() => ì—˜ë¦¬ë¨¼íŠ¸ êµ¬ì¡°ë¥¼ ë³´ì—¬ì¤Œ
  ```

  react testing libraryì—ì„œëŠ” ë©”ì†Œë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ë‘ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì§€ì›í•œë‹¤

  1. ë©”ì†Œë“œë¥¼ import í•´ì˜¤ëŠ” ë°©ë²•
  2. screen ê°ì²´ì—ì„œ ì°¸ì¡°í•´ ì“°ëŠ”ë°©ë²•
     screen ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ì—˜ë¦¬ë¨¼íŠ¸ ì¶”ê°€/ì‚­ì œ/ì—…ë°ì´íŠ¸ê°€ ë  ê²½ìš° ìµœì‹ ìƒíƒœë¥¼ ì–»ê¸° ìœ„í•´ì„œ ë¹„êµ¬ì¡°í™” í• ë‹¹ì„ í•˜ì§€ ì•Šê³  ì—˜ë¦¬ë¨¼íŠ¸ì˜ ì†ì„±ë“¤ì„ ì ‘ê·¼ì´ ê°€ëŠ¥í•¨.

- expectì˜ ê²€ì¦ ë©”ì†Œë“œë¥¼ ì •í™•í•˜ê²Œ ì‚¬ìš©í•˜ë„ë¡ í•  ê²ƒ

  ```tsx
  const button = screen.screen.getByTestId('button');

  // âŒ
  expect(button.disabled).toBe(true);
  // error message:
  //  expect(received).toBe(expected) // Object.is equality
  //
  //  Expected: true
  //  Received: false
  // âœ…
  expect(button).toBeDisabled();
  // error message:
  //   Received element is not disabled:
  //     <button />
  ```

  ë‹¤ìŒ ì½”ë“œì™€ ê°™ì´ expect ë’¤ì— ë“¤ì–´ê°ˆ ë©”ì†Œë“œê°€ ì¢€ë” êµ¬ì²´ì ì¼ ê²½ìš° ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë””ë²„ê¹…ì´ ìˆ˜ì›”í•˜ê²Œ ë„ì›Œì¤€ë‹¤. ì›í™œí•œ ë””ë²„ê¹…ì„ ìœ„í•´ ì •í™•í•œ ê²€ì¦ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì

- getByText ì‚¬ìš©ì— ì§€ì–‘

  ```tsx
  <button data-testid="helloWorld">Hello World</button>;
  // 1. Wrong! ğŸ˜“
  screen.getByText(/hello world/i);

  // 2. Best! ğŸ˜„
  screen.getByTestId('helloWorld');
  ```

- fireEvent ì‚¬ìš©ì— ì£¼ì˜í•  ê²ƒ
  ```tsx
  // âŒ
  fireEvent.change(input, { target: { value: 'hello world' } });
  // âœ…
  userEvent.type(input, 'hello world');
  ```
  fireEventëŠ” ìœ ì € í–‰ë™ì— ì¹œìˆ™í•œ ë°©ì‹ì˜ ë©”ì„œë“œë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì„œ input ì´ë²¤íŠ¸ê°€ ë³€ê²½ë  ë•Œ(keyDown, keyPress, keyUp) í˜¸ì¶œë˜ê²Œ ë˜ë‹¤ ë³´ë‹ˆ, ê°œë°œì ì¸¡ë©´ì—ì„œëŠ” í˜¼ë€ì„ ì¤„ ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.
  fireEvent ë³´ë‹¤ëŠ” useEvent ë©”ì„œë“œëŠ” ì´ë²¤íŠ¸ì˜ íŠ¹ì„±ì— ë”°ë¼ í˜¸ì¶œë¨ìœ¼ë¡œ ì›í• í•œ ë””ë²„ê¹…ì„ ìœ„í•´ì„œëŠ” userEventë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- findì— waitForì´ ë‚´ì¥ë˜ì–´ ìˆë‹¤

  ```tsx
  // âŒ
  const submitButton = await waitFor(() =>
    screen.screen.getByTestId('submit');
  )

  // âœ…
  const submitButton = await screen.findByTestId('submit');
  ```

  findë¡œ ì¡°í•©ë˜ëŠ” ë©”ì†Œë“œë“¤ì€ ëª¨ë‘ waitForì´ ë‚´ì¥ ë˜ì–´ìˆë‹¤. find í˜¹ì€ waitForì„ ì“°ê²Œ ëœë‹¤ë©´ ì´ì  ì£¼ì˜í•´ì„œ ì‚¬ìš©í•˜ë„ë¡ í•˜ì.

- Wrapping things in act unnecessarily
  render, fireEventì—ì„œ ìì²´ì ìœ¼ë¡œ actë¥¼ ë˜í•‘í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•˜ê²Œ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
  actì— ì‚¬ìš©ìš©ë„ëŠ” state ìƒíƒœë¥¼ ë³€ê²½ ì‹œ ìˆ˜ë™ìœ¼ë¡œ DOMì„ ì—…ë°ì´íŠ¸ í•  ê²½ìš° í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.

  ```tsx
  / âŒ
  act(() => {
    render(<Example />)
  })

  const input = screen.getByRole('textbox', {name: /choose a fruit/i})
  act(() => {
    fireEvent.keyDown(input, {key: 'ArrowDown'})
  })

  // âœ…
  render(<Example />)
  const input = screen.getByRole('textbox', {name: /choose a fruit/i})
  fireEvent.keyDown(input, {key: 'ArrowDown'})
  ```

- ì˜ëª»ëœ ì¿¼ë¦¬ ì‚¬ìš© ê°œì„ 
  ì‚¬ìš©ì ë™ì„ ê³¼ ê°€ê¹ê²Œ ì¿¼ë¦¬ ì§„í–‰í•˜ê¸°

  ```
  // âŒ
  // assuming you've got this DOM to work with:
  // <label>Username</label><input data-testid="username" />
  screen.getByTestId('username')

  // âœ…
  // change the DOM to be accessible by associating the label and setting the type
  // <label for="username">Username</label><input id="username" type="text" />
  screen.getByRole('textbox', {name: /username/i})
  ```

  container/querySelector ì‚¬ìš©í•œ ìš”ì†Œ ì¿¼ë¦¬ ì§€ì–‘

  ```
  // âŒ
  const { container } = render(<Example />);
  const button = container.querySelector(".btn-primary");
  expect(button).toHaveTextContent(/click me/i);
  // âœ…
  render(<Example />);
  screen.getByRole("button", { name: /click me/i });
  ```

  â†’ ìš©ë„ì— ë§ëŠ” query í•¨ìˆ˜ ì‚¬ìš©

- ë¶ˆí•„ìš”í•œ ì ‘ê·¼ì„± ì†ì„±ì€ ì¶”ê°€í•˜ì§€ ì•Šê¸°

  ```jsx
  // âŒ
  render(<button role="button">Click me</button>);

  // âœ…
  // button elementì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ role ì†ì„±ì´ buttonì„ìœ¼ë¡œ role=button ì¶”ê°€í•˜ì§€ ì•Šê¸°
  render(<button>Click me</button>);
  ```

- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì²´í¬í•˜ëŠ” ì™¸ì—ëŠ” query\* ë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸°

  ```jsx
  // âŒ
  expect(screen.queryByRole('alert')).toBeInTheDocument();

  // âœ…
  expect(screen.getByRole('alert')).toBeInTheDocument();
  expect(screen.queryByRole('alert')).not.toBeInTheDocument();
  ```

- Query

  - query vs get vs find
    **query**
    - queryByì¼ì¹˜í•˜ëŠ” 1ê°œì˜ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ê²€ìƒ‰í•œë‹¤. ë¨¼ì € querySelectorAllë¡œ ëª¨ë“  ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ê³  ì—†ì„ ê²½ìš° nullì„, 1ê°œì¼ ê²½ìš° ë…¸ë“œ ë¦¬ìŠ¤íŠ¸ì˜ ì²« ë²ˆì§¸ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤. 2ê°œ ì´ìƒì¼ ê²½ìš°ì—ëŠ” ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.
    - queryAllByì¼ì¹˜í•˜ëŠ” ëª¨ë“  ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ê²€ìƒ‰í•œë‹¤. querySelectorAllì˜ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•œë‹¤.
      **get**
    - getByì¼ì¹˜í•˜ëŠ” 1ê°œì˜ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ê²€ìƒ‰í•œë‹¤. ë¨¼ì € querySelectorAllë¡œ ëª¨ë“  ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ê³  1ê°œì¼ ê²½ìš° ë…¸ë“œ ë¦¬ìŠ¤íŠ¸ì˜ ì²« ë²ˆì§¸ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤. ì—†ê±°ë‚˜ 2ê°œ ì´ìƒì¼ ê²½ìš°ì—ëŠ” ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.
    - getAllByì¼ì¹˜í•˜ëŠ” ëª¨ë“  ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ê²€ìƒ‰í•œë‹¤. querySelectorAllì˜ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•œë‹¤. ì¼ì¹˜í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ê°€ ì—†ì„ ê²½ìš° ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.
      **find**
      Promiseë¥¼ ë¦¬í„´í•˜ëŠ” ê²ƒë§Œ ì œì™¸í•˜ë©´ get íƒ€ì…ê³¼ ë™ì¼í•˜ë‹¤. [waitFor](https://testing-library.com/docs/dom-testing-library/api-async/#waitfor) ë©”ì„œë“œë¥¼ ê°ì‹¸ëŠ” í˜•íƒœë¡œ ë˜ì–´ ìˆì–´ì„œ ì—ëŸ¬ë¥¼ ë˜ì§€ì§€ ì•Šì„ ë•Œê¹Œì§€ ê²€ìƒ‰ì„ ì¬ì‹œë„í•œë‹¤.
      **ì–´ëŠ ê²½ìš°ì— ì‚¬ìš©ì„ í•´ì•¼í• ê¹Œ??**
      queryëŠ” ì—˜ë¦¬ë¨¼íŠ¸ê°€ ì—†ì–´ë„ ì—ëŸ¬ë¥¼ ë˜ì§€ì§€ ì•Šê¸° ë•Œë¬¸ì— ì—˜ë¦¬ë¨¼íŠ¸ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ë° ì í•©í•˜ë‹¤. get ì„ ê¸°ë³¸ ì˜µì…˜ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ì—˜ë¦¬ë¨¼íŠ¸ê°€ ë Œë”ë§ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ìƒí™©ì´ ìˆë‹¤ë©´ findë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ì¢‹ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤.
      ![Untitled](./images/24/Untitled.png)
  - ì¿¼ë¦¬ ìš°ì„ ìˆœìœ„
    - ì‹œê° ìš”ì†Œ/ ì‚¬ìš©ìì˜ ì¸í„°ë ‰ì…˜ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ì¿¼ë¦¬ë“¤ ê°„ ìš°ì„ ìˆœìœ„
      - getByRole > getByLabelText > getByPlaceholderText > getByText > getByDisplayValue
    - HTML5 ì™€ ARIA ì†ì„±ì„ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•œ ì¿¼ë¦¬ë“¤ ê°„ ìš°ì„ ìˆœìœ„
      - getByAltText > getByTitle
    - í…ŒìŠ¤íŠ¸ ID: ìœ„ì— ì¿¼ë¦¬ë“¤ë¡œë„ ë¶ˆê°€ëŠ¥í•œ ê°’ì„ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ì„œë§Œ ì‚¬ìš©
      - getByTestId
        [https://testing-library.com/docs/queries/about/#priority](https://testing-library.com/docs/queries/about/#priority)
  - ByRole
    - API: getByRole, queryByRole, getAllByRole, queryAllByRole, findByRole, findAllByRole
    - ì„¤ëª…
      - ì—­í• ì„ ê°€ì§„ ìš”ì†Œë¥¼ domì—ì„œ ì–»ì–´ì˜¬ ê²½ìš° ì‚¬ìš©
      - ì›¹ì ‘ê·¼ì„±ì— aria-role ì˜ë¯¸ì™€ ì¼ì¹˜í•˜ëŠ” í‚¤ê°’ì„ í†µí•´ì„œ domì„ ì–»ì–´ ì˜¬ ìˆ˜ ìˆìŒ.
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/byrole](https://testing-library.com/docs/queries/byrole)
      - ìì£¼ ì‚¬ìš©ë˜ëŠ” role ì •ë¦¬: [https://www.w3.org/TR/html-aria/#sotd](https://www.w3.org/TR/html-aria/#sotd)
        [ì œëª© ì—†ìŒ](https://www.notion.so/480e494982234b839e945e225b4642dc)
  - ByLabelText

    - API: getByLabelText, queryByLabelText, getAllByLabelText, queryAllByLabelText, findByLabelText, findAllByLabelText
    - ì„¤ëª…
      - label ì—˜ë¦¬ë¨¼íŠ¸ì™€ aria-label\* ë¬¸êµ¬ì™€ ì¼ì¹˜í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì–»ì–´ì˜¬ ë•Œ ì‚¬ìš©
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/bylabeltext](https://testing-library.com/docs/queries/bylabeltext)

    ```jsx
    // for/htmlFor relationship between label and form element id
    <label for="username-input">Username</label>
    <input id="username-input" />

    // The aria-labelledby attribute with form elements
    <label id="username-label">Username</label>
    <input aria-labelledby="username-label" />

    // Wrapper labels
    <label>Username <input /></label>

    // Wrapper labels where the label text is in another child element
    <label>
      <span>Username</span>
      <input />
    </label>

    // aria-label attributes
    // Take care because this is not a label that users can see on the page,
    // so the purpose of your input must be obvious to visual users.
    <input aria-label="Username" />
    ```

  - ByText

    - API: getByText, queryByText, getAllByText, queryAllByText, findByText, findAllByText
    - ì„¤ëª…
      - ëª¨ë“  ì—˜ë¦¬ë¨¼íŠ¸ì˜ í…ìŠ¤íŠ¸ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì–»ì–´ì˜¬ ë•Œ ì‚¬ìš©
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/bytext](https://testing-library.com/docs/queries/bytext)

    ```jsx
    <a href="/about">About â„¹ï¸</a>
    // type: submit or button
    <input type="submit" value="Send data" />

    const aboutAnchorNode = screen.getByText(/about/i);
    ```

  - ByDisplayValue

    - API: getByDisplayValue, queryByDisplayValue, getAllByDisplayValue, queryAllByDisplayValue, findByDisplayValue, findAllByDisplayValue
    - ì„¤ëª…
      - input, textarea, selectì— í™”ë©´ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì–»ì–´ì˜¬ ë•Œ ì‚¬ìš©
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/bydisplayvalue](https://testing-library.com/docs/queries/bydisplayvalue)

    ```jsx
    <input type="text" id="lastName" />;
    document.getElementById('lastName').value = 'Norris';

    const lastNameInput = screen.getByDisplayValue('Norris');
    ```

  - ByTestId

    - API: getByTestId, queryByTestId, getAllByTestId, queryAllByTestId, findByTestId, findAllByTestId
    - ì„¤ëª…
      - ëª¨ë“  elementì— title ì†ì„±ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì–»ì–´ì˜¬ ë•Œ ì‚¬ìš©
      - ë‹¤ë¥¸ ì¿¼ë¦¬ë¬¸ì´ ë™ì‘í•˜ì§€ ì•Šì„ ê²½ìš°ì—ë§Œ testidë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/bytitle](https://testing-library.com/docs/queries/bytitle)

    ```
    <div data-testid="custom-element" />

    const element = screen.getByTestId('custom-element');
    ```

  - ByPlaceholderText

    - API: getByPlaceholderText, queryByPlaceholderText, getAllByPlaceholderText, queryAllByPlaceholderText, findByPlaceholderText, findAllByPlaceholderText
    - ì„¤ëª…
      - ëª¨ë“  elementì— placeholder ì†ì„±ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì–»ì–´ì˜¬ ë•Œ ì‚¬ìš©
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/byplaceholdertext](https://testing-library.com/docs/queries/byplaceholdertext)

    ```
    <input placeholder="Username" />

    const inputNode = screen.getByPlaceholderText('Username');
    ```

  - ByAltText

    - API: getByAltText, queryByAltText, getAllByAltText, queryAllByAltText, findByAltText, findAllByAltText
    - ì„¤ëª…
      - ì´ë¯¸ì§€ elementì— alt ì†ì„±ê°’ê³¼ ì¼ì°¨í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì–»ì–´ì˜¬ ë•Œ ì‚¬ìš©
    - ì°¸ê³  URL
      - [https://testing-library.com/docs/queries/byalttext](https://testing-library.com/docs/queries/byalttext)

    ```
    <img alt="Incredibles 2 Poster" src="/incredibles-2.png" />

    const incrediblesPosterImg = screen.getByAltText(/incredibles.*? poster/i);
    ```

<p style="font-size: 25px; font-weight: bold;">Jest Expect</p>

- .toBe(value)
  toBeë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ê°’ì„ ë¹„êµí•˜ê±°ë‚˜ Object ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡° ID(**Shallow compare**)ë¥¼ ì²´í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```tsx
  const can = {
    name: 'pamplemousse',
    ounces: 12,
  };

  describe('the can', () => {
    test('has 12 ounces', () => {
      expect(can.ounces).toBe(12);
    });

    test('has a sophisticated name', () => {
      expect(can.name).toBe('pamplemousse');
    });
  });

  test('toBeëŠ” objê°€ ê°™ì€ ê°ì²´ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆëŠ”ì§€ í™•ì¸í•œë‹¤', () => {
    const obj = {};
    expect(obj).toBe(obj); // true
  });

  test('ê°ì²´ì˜ ë‚´ìš©ì´ ê°™ë”ë¼ë„ ì„œë¡œ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ì— ìˆëŠ” ê°ì²´ì´ê¸° ë•Œë¬¸ì— toBeë¥¼ ì“°ë©´ falseê°€ ë‚˜ì˜¨ë‹¤.', () => {
    expect({ name: 'John' }).toBe({ name: 'John' }); // false
  });
  ```

- .toEqual(value)
  ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ëª¨ë“  ì†ì„±ì„ ì¬ê·€ì ìœ¼ë¡œ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```tsx
  const can1 = {
    flavor: 'grapefruit',
    ounces: 12,
  };
  const can2 = {
    flavor: 'grapefruit',
    ounces: 12,
  };

  describe('the La Croix cans on my desk', () => {
    test('have all the same properties', () => {
      expect(can1).toEqual(can2);
    });
    test('are not the exact same can', () => {
      expect(can1).not.toBe(can2);
    });
  });

  test('ëŒ€ì‹ ì— ê°ì²´ì˜ ë‚´ìš©ì´ ê°™ì€ì§€ë¥¼ í™•ì¸í•˜ë ¤ë©´ toEqualì„ ì¨ì•¼ í•œë‹¤', () => {
    const obj = {};
    expect({ name: 'John' }).toEqual({ name: 'John' }); // true
  });
  ```

- .toBeNull(), toBeUndefined()
  .toBeNull()ì€ .toBe(null)ê³¼ ë™ì¼í•˜ì§€ë§Œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ì¡°ê¸ˆ ë” ì¢‹ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë¬´ì–¸ê°€ê°€ nullì¸ì§€ í™•ì¸í•˜ë ¤ë©´ .toBeNull()ì„ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤
  .toBeUndefined()ì€ .toBeUndefined(null)ê³¼ ë™ì¼í•˜ì§€ë§Œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ì¡°ê¸ˆ ë” ì¢‹ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë¬´ì–¸ê°€ê°€ undefinedì¸ì§€ í™•ì¸í•˜ë ¤ë©´ .toBeUndefined()ì„ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤

  ```tsx
  function bloop() {
    return null;
  }

  test('bloop returns null', () => {
    expect(bloop()).toBeNull();
  });

  test('the best drink for octopus flavor is undefined', () => {
    expect(bestDrinkForFlavor('octopus')).toBeUndefined();
  });
  ```

- .toBeTruthy(), .toBeFalsy()
  .toBeTruthy()ëŠ” .toBeFalsyì˜ ë°˜ëŒ€ë¡œ, ê°’ì´ ë¬´ì—‡ì¸ì§€ì™€ëŠ” ìƒê´€ì—†ì´ boolean ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê°’ì´ trueì¸ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ë•Œ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.
  ëŠìŠ¨í•œ íƒ€ì… ê¸°ë°˜ ì–¸ì–´ì¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” true/false ê°€ boolean íƒ€ì…ë§Œìœ¼ë¡œ ê°„ì£¼ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìˆ«ì 1ì´ true, ìˆ«ì 0ì´ falseë¡œ ê°„ì£¼ë˜ê²Œ ë˜ëŠ”ë° ê·¸ ëŠìŠ¨í•œ íƒ€ì… ê¸°ë°˜ì„ ì²´í¬í•˜ëŠ” í•  ê²½ìš° toBeTruthy, toBeFalsyë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.
  ```tsx
  test('number 0 is falsy but string 0 is truthy', () => {
    expect(0).toBeFalsy();
    expect('0').toBeTruthy();
  });
  ```
- .toHaveLength(number)
  .toHaveLengthëŠ” ê°ì²´ì— .length ì†ì„±ì´ ìˆê³  íŠ¹ì • ìˆ«ìê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  ```tsx
  expect([1, 2, 3]).toHaveLength(3);
  expect('abc').toHaveLength(3);
  expect('').not.toHaveLength(5);
  ```
- .toHaveProperty(keyPath, value?)
  .toHavePropertyëŠ” ê°ì²´ì•ˆì— ì°¸ì¡° keyPathì˜ ì†ì„±ì´ ì¡´ì¬í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  ìˆ˜ì‹ ëœ íŠ¹ì • ê°’ ë¹„êµë¥¼ ìœ„í•´ì„œëŠ”, ì„ íƒì ìœ¼ë¡œ value ì¸ìˆ˜ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```tsx
  // Object containing house features to be tested
  const houseForSale = {
    bath: true,
    bedrooms: 4,
    kitchen: {
      amenities: ['oven', 'stove', 'washer'],
      area: 20,
      wallColor: 'white',
      'nice.oven': true,
    },
    livingroom: {
      amenities: [
        {
          couch: [
            ['large', { dimensions: [20, 20] }],
            ['small', { dimensions: [10, 10] }],
          ],
        },
      ],
    },
    'ceiling.height': 2,
  };

  test('this house has my desired features', () => {
    // Example Referencing
    expect(houseForSale).toHaveProperty('bath');
    expect(houseForSale).toHaveProperty('bedrooms', 4);

    expect(houseForSale).not.toHaveProperty('pool');

    // Deep referencing using dot notation
    expect(houseForSale).toHaveProperty('kitchen.area', 20);
    expect(houseForSale).toHaveProperty('kitchen.amenities', [
      'oven',
      'stove',
      'washer',
    ]);

    expect(houseForSale).not.toHaveProperty('kitchen.open');

    // Deep referencing using an array containing the keyPath
    expect(houseForSale).toHaveProperty(['kitchen', 'area'], 20);
    expect(houseForSale).toHaveProperty(
      ['kitchen', 'amenities'],
      ['oven', 'stove', 'washer'],
    );
    expect(houseForSale).toHaveProperty(['kitchen', 'amenities', 0], 'oven');
    expect(houseForSale).toHaveProperty(
      'livingroom.amenities[0].couch[0][1].dimensions[0]',
      20,
    );
    expect(houseForSale).toHaveProperty(['kitchen', 'nice.oven']);
    expect(houseForSale).not.toHaveProperty(['kitchen', 'open']);

    // Referencing keys with dot in the key itself
    expect(houseForSale).toHaveProperty(['ceiling.height'], 'tall');
  });
  ```

- .toHaveBeenCalled()
  .toHaveBeenCalled()ëŠ” ëª¨ì˜ í•¨ìˆ˜ê°€ í˜¸ì¶œ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```tsx
  function drinkAll(callback, flavour) {
    if (flavour !== 'octopus') {
      callback(flavour);
    }
  }

  describe('drinkAll', () => {
    test('drinks something lemon-flavoured', () => {
      const drink = jest.fn();
      drinkAll(drink, 'lemon');
      expect(drink).toHaveBeenCalled(); // drink ëª¨ì˜í•¨ìˆ˜ê°€ í˜¸ì¶œì—¬ë¶€ í™•ì¸(callback)
    });

    test('does not drink something octopus-flavoured', () => {
      const drink = jest.fn();
      drinkAll(drink, 'octopus');
      expect(drink).not.toHaveBeenCalled(); // drink ëª¨ì˜í•¨ìˆ˜ê°€ í˜¸ì¶œì—¬ë¶€ í™•ì¸(callback)
    });
  });
  ```

- .arrayContaining(array)
  .arrayContaining(array)ëŠ” ìˆ˜ì‹ ëœ ë°°ì—´ì— ì˜ˆìƒë˜ëŠ” ë°°ì—´ì˜ ìš”ì†Œë“¤ì´ í¬í•¨ë˜ëŠ”ì§€ íŒë‹¨í•©ë‹ˆë‹¤.
  ì¦‰, ì˜ˆìƒë˜ëŠ” ë°°ì—´ì„ ìˆ˜ì‹ ëœ ë°°ì—´ì˜ í•˜ìœ„ ì§‘í•©ì…ë‹ˆë‹¤.
  ```tsx
  describe('arrayContaining', () => {
    const expected = ['Alice', 'Bob'];
    it('matches even if received contains additional elements', () => {
      expect(['Alice', 'Bob', 'Eve']).toEqual(expect.arrayContaining(expected));
    });
    it('does not match if received does not contain expected elements', () => {
      expect(['Bob', 'Eve']).not.toEqual(expect.arrayContaining(expected));
    });
  });
  ```
- .toContain
  - ë°°ì—´ì˜ ì•„ì´í…œì„ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì²´í¬í•´ì•¼í•  ê²½ìš° ì‚¬ìš©
  ```tsx
  test('the flavor list contains lime', () => {
    expect(['lime', 'mangle']).toContain('lime');
  });
  ```
  - ìˆ˜ì‹ ëœ ë¬¸ìì—´ì´ ì˜ˆìƒëœ ë¬¸ìì—´ì´ í¬í•¨ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì²´í¬í•  ê²½ìš° ì‚¬ìš©
  ```tsx
  test('the flavor list contains lime', () => {
    expect('lime juice').toContain('lime');
  });
  ```
- .toBeInTheDocument
  í•´ë‹¹ ì—˜ë¦¬ë¨¼íŠ¸ê°€ documentì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ê²½ìš° ì‚¬ìš©

  ```tsx
  import { render, screen } from '@testing-library/react';
  import App from './App';

  test('renders learn react link', () => {
    render(<App />);
    const linkElement = screen.getByText(/learn react/i);
    expect(linkElement).toBeInTheDocument();
  });
  ```

- .toBeCalledTimes
  ëª¨ì˜ í•¨ìˆ˜ê°€ ëª‡ë²ˆ í˜¸ì¶œë˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ê²½ìš° ì‚¬ìš©

  ```tsx
  const mockFn = jest.fn();

  mockFn(10, 20);
  mockFn();
  mockFn(30, 40);

  test('í•œë²ˆ ì´ìƒ í˜¸ì¶œ?', () => {
    expect(mockFn).toBeCalled();
  });

  test('ì •í™•íˆ 3ë²ˆ í˜¸ì¶œ?', () => {
    expect(mockFn).toBeCalledTimes(3);
  });

  test('10ì´ë‘ 20ì„ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ì€ í•¨ìˆ˜ê°€ ìˆëŠ”ê°€', () => {
    expect(mockFn).toBeCalledWith(10, 20);
  });

  test('ë§ˆì§€ë§‰ í•¨ìˆ˜ëŠ” 30ì´ë‘ 40 ë°›ì•˜ìŒ?', () => {
    expect(mockFn).lastCalledWith(30, 40);
  });
  ```

- .toMatchSnapshot
  íŒŒì¼ ìŠ¤ëƒ…ìƒ· í…ŒìŠ¤íŠ¸ ì§€ì›ì„ í•´ì•¼í•  ê²½ìš° ì‚¬ìš©
  í…ŒìŠ¤íŠ¸ ì™„ë£Œ ìˆ˜ **snapshots** ë””ë ‰í† ë¦¬ê°€ ìƒì„±ë˜ê³ , ê·¸ ì•ˆì— repeat.test.js.snap íŒŒì¼ì´ ìƒì„±ë¨.

  ```tsx
  import repeat from './repeat';

  test('repeats words three times', () => {
    expect(repeat('Test', 3)).toMatchSnapshot();
  });
  ```

- .toHaveTextContent
  ì—˜ë¦¬ë¨¼íŠ¸ì˜ í…ìŠ¤íŠ¸ì˜ ë¹„êµë¥¼ í•´ì•¼í•  ê²½ìš° ì‚¬ìš©

  ```tsx
  import React from 'react';
  import App from '../App';
  import { fireEvent, render } from '@testing-library/react';

  describe('<App /> test', () => {
    it('matches snapshopt', () => {
      const utils = render(<App />);
      expect(utils.container).toMatchSnapshot(); // snapshot match
    });

    it('screen test', () => {
      const utils = render(<App />);

      const h2 = utils.container.querySelector('h2'); // h2íƒœê·¸ DOM ê°€ì ¸ì˜¤ê¸°
      h2 && expect(h2.innerHTML).toBe('Hello. Jest!!'); // h2ì˜ innerHTMLì´ Hello, Jest!! ì¸ì§€ í…ŒìŠ¤íŠ¸
    });

    it('button test', () => {
      const utils = render(<App />);

      const str = utils.getByText('number: 0'); // í…ìŠ¤íŠ¸ê°€ number: 0ì¸ DOM ê°€ì ¸ì˜¤ê¸°
      const increaseButton = utils.getByText('ì¦ê°€'); // í…ìŠ¤íŠ¸ê°€ ì¦ê°€ì¸ DOM ê°€ì ¸ì˜¤ê¸°
      const decreaseButton = utils.getByText('ê°ì†Œ'); // í…ìŠ¤íŠ¸ê°€ ê°ì†Œì¸ DOM ê°€ì ¸ì˜¤ê¸°

      fireEvent.click(increaseButton); // ì¦ê°€ë²„íŠ¼ í´ë¦­ì´ë²¤íŠ¸ ì‹¤í–‰
      fireEvent.click(increaseButton); // ì¦ê°€ë²„íŠ¼ í´ë¦­ì´ë²¤íŠ¸ ì‹¤í–‰
      expect(str).toHaveTextContent('number: 6'); // strì˜ í…ìŠ¤íŠ¸ê°€ number: 6ì¸ì§€ í™•ì¸

      fireEvent.click(decreaseButton); // ê°ì†Œë²„íŠ¼ í´ë¦­ì´ë²¤íŠ¸ ì‹¤í–‰
      fireEvent.click(decreaseButton); // ê°ì†Œë²„íŠ¼ í´ë¦­ì´ë²¤íŠ¸ ì‹¤í–‰
      expect(str).toHaveTextContent('number: 2'); // strì˜ í…ìŠ¤íŠ¸ê°€ number: 2ì¸ì§€ í™•ì¸
    });
  });
  ```

- .toBeDisabled
  ì—˜ë¦¬ë¨¼íŠ¸ê°€ ë¹„í™œì„±í™” ì¸ì§€ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©
  ```tsx
  expect(screen.getByRole('button')).toHaveTextContent('ëŒ€ê¸°ì¤‘');
  expect(screen.getByRole('button')).toBeDisabled();
  ```
- .toBeCalled
  í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©

  ```tsx
  fireEvent.click(screen.getByTestId('app-install-modal-close-button'));

  // Then
  expect(onClose).toBeCalled();
  ```

- .toBeRequired
  ì—˜ë¦¬ë¨¼íŠ¸ì˜ ì†ì„±ì— required, aria-required=â€trueâ€ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©
  ```tsx
  // example
  <input data-testid="required-input" required />
  <input data-testid="aria-required-input" aria-required="true" />
  <input data-testid="conflicted-input" required aria-required="false" />
  <input data-testid="aria-not-required-input" aria-required="false" />
  <input data-testid="optional-input" />
  <input data-testid="unsupported-type" type="image" required />
  <select data-testid="select" required></select>
  <textarea data-testid="textarea" required></textarea>
  <div data-testid="supported-role" role="tree" required></div>
  <div data-testid="supported-role-aria" role="tree" aria-required="true"></div>
  ```
  ```tsx
  expect(
    document.querySelector('[data-testid="required-input"]'),
  ).toBeRequired();
  expect(
    document.querySelector('[data-testid="aria-required-input"]'),
  ).toBeRequired();
  expect(
    document.querySelector('[data-testid="conflicted-input"]'),
  ).toBeRequired();
  expect(
    document.querySelector('[data-testid="aria-not-required-input"]'),
  ).not.toBeRequired();
  expect(
    document.querySelector('[data-testid="unsupported-type"]'),
  ).not.toBeRequired();
  expect(document.querySelector('[data-testid="select"]')).toBeRequired();
  expect(document.querySelector('[data-testid="textarea"]')).toBeRequired();
  expect(
    document.querySelector('[data-testid="supported-role"]'),
  ).not.toBeRequired();
  expect(
    document.querySelector('[data-testid="supported-role-aria"]'),
  ).toBeRequired();
  ```
- .toBeGreaterThan(number | bigint)
  ìˆ˜ì‹ ë°›ì€ ë°ì´í„°(received)ë³´ë‹¤ ì˜ˆìƒë˜ëŠ” ë°ì´í„°(expected) ë³´ë‹¤ í° ìˆ«ìì¼ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©

  ```tsx
  test('ounces per can is more than 10', () => {
    expect(ouncesPerCan()).toBeGreaterThan(10); // ouncesPerCan() ì´ 10 ì˜¨ìŠ¤ ì´ìƒì˜ ê°’ì„ ë°˜í™˜ í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸
  });
  ```

<p style="font-size: 25px; font-weight: bold;">User Event</p>

package: @testing-library/user-event

- ì„¤ì¹˜
  ```bash
  npm install --save-dev @testing-library/user-event
  or
  yarn add -D @testing-library/user-event
  ```
- API

  - click(element, eventInit, options)

    ```tsx
    import React from 'react';
    import { render, screen } from '@testing-library/react';
    import userEvent from '@testing-library/user-event';

    test('click', () => {
      render(
        <div>
          <label htmlFor="checkbox">Check</label>
          <input id="checkbox" type="checkbox" />
        </div>,
      );

      userEvent.click(screen.getByText('Check'));
      expect(screen.getByLabelText('Check')).toBeChecked();
    });

    userEvent.click(elem, { ctrlKey: true, shiftKey: true });
    userEvent.click(elem, undefined, { skipPointerEventsCheck: true });
    ```

  - type(element, text, [options])

    - input, textarea ì—˜ë¦¬ë¨¼íŠ¸ì•ˆì— í…ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•  ë•Œ ì‚¬ìš©

    ```tsx
    import React from 'react';
    import { render, screen } from '@testing-library/react';
    import userEvent from '@testing-library/user-event';

    test('type', () => {
      render(<textarea />);

      userEvent.type(screen.getByRole('textbox'), 'Hello,{enter}World!');
      expect(screen.getByRole('textbox')).toHaveValue('Hello,\nWorld!');
    });
    ```

  - clear(element)

    - í˜„ì¬ ì„ íƒëœ input/textarea ì—˜ë¦¬ë¨¼íŠ¸ì˜ í…ìŠ¤íŠ¸ê°’ì„ ì‚­ì œí•  ë•Œ ì‚¬ìš©

    ```tsx
    import React from 'react';
    import { render, screen } from '@testing-library/react';
    import userEvent from '@testing-library/user-event';

    test('clear', () => {
      render(<textarea defaultValue="Hello, World!" />);

      userEvent.clear(screen.getByRole('textbox'));
      expect(screen.getByRole('textbox')).toHaveValue('');
    });
    ```

  - dblClick(element, eventInit, options)

    ```jsx
    import React from 'react';
    import { render, screen } from '@testing-library/react';
    import userEvent from '@testing-library/user-event';

    test('double click', () => {
      const onChange = jest.fn();
      render(<input type="checkbox" onChange={onChange} />);
      const checkbox = screen.getByRole('checkbox');
      userEvent.dblClick(checkbox);
      expect(onChange).toHaveBeenCalledTimes(2);
      expect(checkbox).not.toBeChecked();
    });
    ```

  - selectOptions(element, values, options) / deselectOptions(element, values, options)

    ```tsx
    import React from 'react';
    import { render, screen } from '@testing-library/react';
    import userEvent from '@testing-library/user-event';

    test('selectOptions', () => {
      render(
        <select multiple>
          <option value="1">A</option>
          <option value="2">B</option>
          <option value="3">C</option>
        </select>,
      );

      userEvent.selectOptions(screen.getByRole('listbox'), ['1', '3']);

      expect(screen.getByRole('option', { name: 'A' }).selected).toBe(true);
      expect(screen.getByRole('option', { name: 'B' }).selected).toBe(false);
      expect(screen.getByRole('option', { name: 'C' }).selected).toBe(true);

      userEvent.selectOptions(screen.getByRole('listbox'), '2');
      expect(screen.getByText('B').selected).toBe(true);
      userEvent.deselectOptions(screen.getByRole('listbox'), '2');
      expect(screen.getByText('B').selected).toBe(false);
    });
    ```

  - tab({shift, focusTrap})

    - ë¸Œë¼ìš°ì €ì™€ ë™ì¼í•˜ê²Œ tab ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œì¼œì„œ activeElementë¥¼ ë³€ê²½ ì‹œí‚¨ë‹¤.

    ```tsx
    import React from 'react';
    import { render, screen } from '@testing-library/react';
    import '@testing-library/jest-dom';
    import userEvent from '@testing-library/user-event';

    it('should cycle elements in document tab order', () => {
      render(
        <div>
          <input data-testid="element" type="checkbox" />
          <input data-testid="element" type="radio" />
          <input data-testid="element" type="number" />
        </div>,
      );

      const [checkbox, radio, number] = screen.getAllByTestId('element');

      expect(document.body).toHaveFocus();

      userEvent.tab();

      expect(checkbox).toHaveFocus();

      userEvent.tab();

      expect(radio).toHaveFocus();

      userEvent.tab();

      expect(number).toHaveFocus();

      userEvent.tab();

      // cycle goes back to the body element
      expect(document.body).toHaveFocus();

      userEvent.tab();

      expect(checkbox).toHaveFocus();
    });
    ```

  - hover(element, options) / unhover(element, options)

        ```tsx
        import React from 'react';
        import { render, screen } from '@testing-library/react';
        import userEvent from '@testing-library/user-event';
        import Tooltip from '../tooltip';

        test('hover', () => {
          const messageText = 'Hello';
          render(
            <Tooltip messageText={messageText}>
              <TrashIcon aria-label="Delete" />
            </Tooltip>,
          );

          userEvent.hover(screen.getByLabelText(/delete/i));
          expect(screen.getByText(messageText)).toBeInTheDocument();
          userEvent.unhover(screen.getByLabelText(/delete/i));
          expect(screen.queryByText(messageText)).not.toBeInTheDocument();
        });
        ```

# API ìœ ë‹›í…ŒìŠ¤íŠ¸

<p style="font-size: 25px; font-weight: bold;">íŒ¨í‚¤ì§€</p>

- jest
- react-test-renderer
- axios, fetch
<p style="font-size: 25px; font-weight: bold;">í…ŒìŠ¤íŠ¸ ì‚¬í•­</p>

- HTTP ì„±ê³µì—¬ë¶€ í™•ì¸(request code 200)
- API ê¸°ëŒ€ì‘ë‹µì— ëŒ€í•œ ë¹„êµ
- API ì‘ë‹µì´ ê¸¸ ê²½ìš° ì†ì„±ì˜ ê¸¸ì´ë§Œ í…ŒìŠ¤íŠ¸
<p style="font-size: 25px; font-weight: bold;">ì ìš©ì‚¬í•­</p>

ë§í¬: [https://github.com/seungahhong/states-todos/blob/main/src/redux/services/**test**/todo.service.tsx](https://github.com/seungahhong/states-todos/blob/main/src/redux/services/__test__/todo.service.tsx)

```tsx
import { fetchTodo, createTodo, updateTodo, patchTodo, deleteTodo } from '..';

describe('async api test', () => {
  it('shoud async get api to todos a states', async () => {
    const { data } = await fetchTodo();
    const keys = ['userId', 'id', 'title', 'completed'];
    expect(Object.keys(data[0])).toEqual(keys);
  });

  it('shoud async get api to todo a states', async () => {
    const { data } = await fetchTodo(1);
    const keys = ['userId', 'id', 'title', 'completed'];
    expect(Object.keys(data)).toEqual(keys);
  });

  it('shoud async create api to todos a states', async () => {
    const expectData = {
      userId: 1,
      title: 'create',
      body: 'post create',
    };
    const { data, status } = await createTodo(expectData);

    expect(status).toBe(201 /* HTML Response 201 Created */);
    expect({
      userId: data.userId,
      title: data.title,
      body: data.body,
    }).toEqual(expectData);
  });

  it('shoud async put api to todos a states', async () => {
    const expectData = {
      userId: 1,
      id: 1,
      title: 'update',
      body: 'put update',
    };

    const { data, status } = await updateTodo(1, expectData);

    expect(status).toBe(200 /* HTML Response 200 OK */);
    expect(data).toEqual(expectData);
  });

  it('shoud async patch api to todos a states', async () => {
    const expectData = {
      title: 'patch',
    };

    const { data, status } = await patchTodo(1, expectData);

    expect(status).toBe(200 /* HTML Response 200 OK */);
    expect({
      title: data.title,
    }).toEqual(expectData);
  });

  it('shoud async delete api to todos a states', async () => {
    const { status } = await deleteTodo(1);
    expect(status).toBe(200 /* HTML Response 200 OK */);
  });
});
```

# ìƒíƒœê´€ë¦¬ ìœ ë‹›í…ŒìŠ¤íŠ¸

<p style="font-size: 25px; font-weight: bold;">redux ìœ ë‹›í…ŒìŠ¤íŠ¸</p>

ë§í¬: [https://github.com/seungahhong/states-todos/tree/main/src/reduxToolkit/states/features/**test**](https://github.com/seungahhong/states-todos/tree/main/src/reduxToolkit/states/features/__test__)

- íŒ¨í‚¤ì§€
  - jest
  - react-test-renderer
  - axios, fetch
  - redux-thunk
  - axios-mock-adapter
  - fetch-mock
  - redux-mock-store
  - redux-toolkit
  - jest
- í…ŒìŠ¤íŠ¸ ì‚¬í•­

  - Redux Reducer ìœ ë‹›í…ŒìŠ¤íŠ¸

    ```tsx
    import slice, { fetchAction, changeAction } from '..';
    import { configureStore } from '@reduxjs/toolkit';
    // As a basic setup, import your same slice reducers

    export const setupStore = (reducer, preloadedState) => {
      return configureStore({
        reducer: { ...reducer },
        preloadedState,
      });
    };

    const list = [];

    describe('lists redux state test', () => {
      const setup = () => {
        return {
          list,
          store: setupStore({ lists: slice.reducer }, { initialState }), // reducer ì´ˆê¸°ì„¸íŒ…
        };
      };

      it('should return the reducer initial state', () => {
        const { reducer } = setup();
        expect(reducer(undefined, {})).toEqual(initialState);
      });

      it('should handle lists being added to a reducer empty state', () => {
        const { reducer, list } = setup();
        expect(reducer(initialState, fetchAction(list))).toEqual({
          ...initialState,
          lists: list.map(item => ({
            ...item,
          })),
        });
      });
    });
    ```

  - Redux Action ìœ ë‹›í…ŒìŠ¤íŠ¸

    - redux actionì— ëŒ€í•œ ìœ ë‹›í…ŒìŠ¤íŠ¸ ì‘ì„±
      - ë¦¬ë•ìŠ¤ ì•¡ì…˜ ìˆ˜í–‰ í›„ ì˜ˆìƒëœ ë¦¬í„´ê°’ì„ ë¹„êµ

    ```tsx
    import slice, { initialState, fetchAction } from '..';

    export const setupStore = (reducer, preloadedState) => {
      return configureStore({
        reducer: { ...reducer },
        preloadedState,
      });
    };

    const list = [];

    describe('lists redux state test', () => {
      const setup = () => {
        return {
          list,
          store: setupStore({ lists: slice.reducer }, { initialState }), // reducer ì´ˆê¸°ì„¸íŒ…
        };
      };

      it('should handle lists being added fetchAction action state', () => {
        const { store, list } = setup();
        store.dispatch(fetchAction(list));
        const nextState = {
          ...initialState,
          lists: list.map(item => ({
            ...item,
          })),
        };

        expect(store.getState().lists).toEqual(nextState);
      });
    });
    ```

  - Redux-Thunk Action ìœ ë‹›í…ŒìŠ¤íŠ¸

    ```tsx
    // axios ì‚¬ìš©
    describe('async actions test', () => {
      it('shoud async fetch action to todos a states', async () => {
        const todoItem = [
          {
            userId: 1,
            id: 1,
            title: 'delectus aut autem',
            completed: false,
          },
          {
            userId: 2,
            id: 2,
            title: 'delectus aut autem test',
            completed: false,
          },
        ];

        const store = mockStore();

        mock
          .onGet('https://jsonplaceholder.typicode.com/todos')
          .reply(200, todoItem);

        return store.dispatch(fetchAsyncTodoAction()).then(() => {
          // return of async actions
          // [0]: pending, [1]: fulfilled
          const responses = store.getActions();
          const fetchAction = responses.filter(
            item => item.type === fetchAsyncTodoAction.fulfilled.type,
          )[0];

          expect(fetchAction.payload.todoItem).toHaveLength(todoItem.length);
        });
      });

      it('shoud async fetch action to todo a states', async () => {
        const id = 1;
        const todoItem = [
          {
            userId: 1,
            id: id,
            title: 'delectus aut autem',
            completed: false,
          },
        ];

        const store = mockStore();

        mock
          .onGet(`https://jsonplaceholder.typicode.com/todos/${id}`)
          .reply(200, todoItem);

        return store.dispatch(fetchAsyncTodoAction(id)).then(() => {
          // return of async actions
          // [0]: pending, [1]: fulfilled
          const expectedActions = {
            todoItem,
          };

          const responses = store.getActions();
          const fetchAction = responses.filter(
            item => item.type === fetchAsyncTodoAction.fulfilled.type,
          )[0];

          expect(fetchAction.payload).toEqual(expectedActions);
        });
      });

      it('shoud async create action to todo a states', async () => {
        const todoItem = [
          {
            userId: 2,
            title: 'create',
            completed: true,
          },
        ];

        const store = mockStore();

        mock
          .onPost(`https://jsonplaceholder.typicode.com/posts`)
          .reply(201, todoItem);

        return store
          .dispatch(createAsyncTodoAction(todoItem[0] as TodoItem))
          .then(() => {
            // return of async actions
            // [0]: pending, [1]: fulfilled
            const expectedActions = {
              todoItem,
            };

            const responses = store.getActions();
            const action = responses.filter(
              item => item.type === createAsyncTodoAction.fulfilled.type,
            )[0];

            expect(action.payload).toEqual(expectedActions);
          });
      });

      it('shoud async update action to todo a states', async () => {
        const id = 1;
        const todoItem = {
          userId: id,
          id: id,
          title: 'update',
          completed: true,
        };

        const store = mockStore();

        mock
          .onPut(`https://jsonplaceholder.typicode.com/posts/${id}`)
          .reply(200, todoItem);

        return store
          .dispatch(
            updateAsyncTodoAction({
              id,
              todoItem,
            }),
          )
          .then(() => {
            // return of async actions
            // [0]: pending, [1]: fulfilled
            const expectedActions = {
              id,
              data: todoItem,
            };

            const responses = store.getActions();
            const action = responses.filter(
              item => item.type === updateAsyncTodoAction.fulfilled.type,
            )[0];

            expect(action.payload).toEqual(expectedActions);
          });
      });

      it('shoud async delete action to todo a states', async () => {
        const id = 1;

        const store = mockStore();

        mock
          .onDelete(`https://jsonplaceholder.typicode.com/posts/${id}`)
          .reply(200);

        return store.dispatch(deleteAsyncTodoAction(id)).then(() => {
          // return of async actions
          // [0]: pending, [1]: fulfilled

          const responses = store.getActions();
          const action = responses.filter(
            item => item.type === deleteAsyncTodoAction.fulfilled.type,
          )[0];

          const expectedActions = {
            id,
          };

          expect(action.payload).toEqual(expectedActions);
        });
      });
    });

    // fetch ì‚¬ìš©
    import thunk from 'redux-thunk';
    import configureStore from 'redux-mock-store';
    import fetchMock from 'fetch-mock';

    import reducer from '../features';

    import { FETCH_TODOS } from '../constants';
    import { fetchAsyncTodosAction, fetchTodosAction } from '../features';
    import { TodoAction, TodoItemState, TodoState } from '../types';

    const middlewares = [thunk];
    const mockStore = configureStore(middlewares);

    describe('async actions test', () => {
      afterEach(() => {
        fetchMock.restore();
      });

      it('shoud async action to todo a states', async () => {
        const todoItems = [
          {
            userId: 1,
            id: 1,
            title: 'delectus aut autem',
            completed: false,
          },
        ] as TodoItemState[];

        fetchMock.getOnce('https://jsonplaceholder.typicode.com/todos', {
          body: { todos: todoItems },
          headers: { 'content-type': 'application/json' },
        });

        const store = mockStore({ payload: { todos: [] } });

        return store.dispatch(fetchAsyncTodosAction()).then(() => {
          // return of async actions
          // [0]: pending, [1]: FETCH_TODOS, [2]: fulfilled
          const responses: TodoAction[] = store.getActions();
          const fulfilled = responses.filter(
            item => item.type === fetchAsyncTodosAction.fulfilled.type,
          )[0];

          expect(fulfilled.payload.todos).toEqual(todoItems);
        });
      });
    });
    ```

  - Redux ì ìš©í•œ í™”ë©´ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸

    ```jsx
    import React from 'react';
    import {
      within,
      render,
      screen,
    } from '@testing-library/react';
    import slice, { // reducer, action
      initialState,
      fetchAction,
    } from '..';
    import List from '../List';

    import { configureStore } from '@reduxjs/toolkit';
    // As a basic setup, import your same slice reducers

    export const setupStore = (reducer, preloadedState) => {
      return configureStore({
        reducer: { ...reducer },
        preloadedState,
      });
    };

    const list = [];

    describe('<List />', () => {
      const setup = () => {
        return {
          list,
          store: setupStore({ lists: slice.reducer }, { initialState }), // reducer ì´ˆê¸°ì„¸íŒ…
        };
      };

      const setupRender = (props) => {
        return render(<List
          {...props}
        />);
      };

      it('shoud dispatch fetch state to render', async () => {
        const {
          list,
        } = setup();
        store.dispatch(fetchList(list)); // action ì‹¤í–‰

        setupRender({
          list: store.getState().lists.list,
        });

        const list = screen.getByRole('list');
        const { getAllByRole } = within(list);
        const items = getAllByRole('listitem');
        expect(items.length).toBe(8);
      });
    ```

<p style="font-size: 25px; font-weight: bold;">react-query ìœ ë‹›í…ŒìŠ¤íŠ¸</p>

ë§í¬: [testing-react-query/src at main Â· TkDodo/testing-react-query](https://github.com/TkDodo/testing-react-query/tree/main/src) (msw, jest)

- ì„¤ì¹˜
  ```bash
  npm install @testing-library/react-hooks react-test-renderer --save-dev
  or
  yarn add @testing-library/react-hooks react-test-renderer --save-dev
  ```
- For custom hooks
  @testing-library/react-hooks, @testing-library/react v13.1.0 ì´ìƒì¼ ê²½ìš° Custom Hook í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ì„œ wrapperë¡œ hookë¥¼ ê°ìŒ€ ìˆ˜ ìˆìœ¼ë©° ë Œë”ë§ ì‹œ í…ŒìŠ¤íŠ¸ êµ¬ì„±ìš”ì†Œë¥¼ ê°ì‹¸ì„œ ì‹¤í–‰ì‹œì¼œ ì¤ë‹ˆë‹¤.

  ```tsx
  // @testing-library/react-hooks
  import { renderHook, waitFor } from '@testing-library/react-hooks';

  // @testing-library/react v13.1.0 ì´ìƒ
  import { renderHook, waitFor } from '@testing-library/react';

  export function useCustomHook() {
    return useQuery(['customHook'], () => 'Hello');
  }

  const queryClient = new QueryClient();
  const wrapper = ({ children }) => (
    <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
  );

  const { result, waitFor } = renderHook(() => useCustomHook(), { wrapper });

  await waitFor(() => result.current.isSuccess);

  expect(result.current.data).toEqual('Hello');
  ```

- Turn off retries
  ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 3ë²ˆì˜ ì¬ì‹œë„ë¥¼ í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆëŠ”ë°, ì—ëŸ¬ê°€ ìˆëŠ” ì¿¼ë¦¬ì— ê²½ìš°ì—ëŠ” íƒ€ì„ì•„ì›ƒì´ ê±¸ë¦¬ëŠ” ë¬¸ì œì ì„ ìˆì–´ì„œ ì´ˆê¸° ì„¸íŒ…ì— retryê°’ì„ falseë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

  ```tsx
  import { QueryClient } from 'react-query';

  const queryClient = new QueryClient({
    defaultOptions: {
      queries: {
        // âœ… turns retries off
        retry: false,
      },
    },
  });
  const wrapper = ({ children }) => (
    <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
  );
  ```

- turn-off-network-error-logging
  ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ì— ëŒ€í•´ì„œ ì½˜ì†” ì—ëŸ¬ë¡œ í‘œê¸°ë¥¼ í•©ë‹ˆë‹¤. í•´ë‹¹ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ì™€ í…ŒìŠ¤íŠ¸ ì—ëŸ¬ê°€ ê°™ì´ ì½˜ì†”ì— ë³´ì¼ê²½ìš° í˜¼ë€ì„ ì¤„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í…ŒìŠ¤íŠ¸ í™˜ê²½ì„¸íŒ… ì‹œ ë¡œê¹…ì„ ë„ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

  ```tsx
  import { QueryClient } from 'react-query';

  const queryClient = new QueryClient({
    logger: {
      log: console.log,
      warn: console.warn,
      // âœ… no more errors on the console for tests
      error: process.env.NODE_ENV === 'test' ? () => {} : console.error,
    },
  });
  ```

- setQueryDefaults
  useQueryì— ì˜µì…˜ì„ ìµœëŒ€í•œ ì‚¬ìš©í•˜ì§€ í•˜ì§€ ì•Šê³ , ë””í´ë“œ ì˜µì…˜ì„ ì„¤ì •í•˜ë„ë¡ ë³€ê²½í•´ì•¼í•©ë‹ˆë‹¤. ë‹¨, íŠ¹ì • ì¿¼ë¦¬ì— ëŒ€í•´ì„œ ì˜µì…˜ì„ ì„¤ì •í•´ì•¼í•  ê²½ìš°, queryClient.setQueryDefaultsë¡œ ì„¤ì •í•˜ì„¸ìš”

  ```tsx
  const queryClient = new QueryClient({
    defaultOptions: {
      queries: {
        retry: 2,
      },
    },
  });

  // âœ… only todos will retry 5 times
  queryClient.setQueryDefaults('todos', { retry: 5 });

  function App() {
    return (
      <QueryClientProvider client={queryClient}>
        <Example />
      </QueryClientProvider>
    );
  }
  ```

- Always await the query

  - react-queryëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì‘ë‹µê°’ ì¤‘ isSuccess flagê°€ true ì¼ê²½ìš° ë°ì´í„°ì— ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - í•´ë‹¹ ë¡œì§ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ @testing-library/react-hooks, @testing-library/react v13.1.0 ì´ìƒì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

  ```tsx
  // @testing-library/react-hooks
  import { renderHook, waitFor } from '@testing-library/react-hooks'

  const createWrapper = () => {
    const queryClient = new QueryClient({
      defaultOptions: {
        queries: {
          retry: false,
        },
      },
    })
    return ({ children }) => (
      <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
    )
  }

  test("my first test", async () => {
    const { result, waitFor } = renderHook(() => useCustomHook(), {
      wrapper: createWrapper()
    })

    // âœ… wait until the query has transitioned to success state
    await waitFor(() => result.current.isSuccess)

    expect(result.current.data).toBeDefined()
  }

  // @testing-library/react v13.1.0 ì´ìƒ
  import { waitFor, renderHook } from '@testing-library/react'

  test("my first test", async () => {
    const { result } = renderHook(() => useCustomHook(), {
      wrapper: createWrapper()
    })

    // âœ… return a Promise via expect to waitFor
    await waitFor(() => expect(result.current.isSuccess).toBe(true))

    expect(result.current.data).toBeDefined()
  }
  ```

- MSW ì—°ë™

  ````tsx
  import { renderHook } from "@testing-library/react";
  import { useApi } from "../useApi";
  import { rest, setupServer } from "msw/node";

        import axios from 'axios'
        import { useQuery } from 'react-query'

        const fetchRepoData = (): Promise<{ name: string }> =>
            axios
                .get('https://api.github.com/repos/tannerlinsley/react-query')
                .then((response) => response.data)

        export function useRepoData() {
            return useQuery(['repoData'], fetchRepoData)
        }
        );

        beforeAll(() => worker.listen());
        afterEach(() => worker.resetHandlers());
        afterAll(() => worker.stop());

        describe('query hook', () => {
            test('successful query hook', async () => {
                const { result } = renderHook(() => useRepoData(), {
                    wrapper: createWrapper()
                })

                await waitFor(() => expect(result.current.isSuccess).toBe(true))

                expect(result.current.data?.name).toBe('mocked-react-query')
            })

            test('failure query hook', async () => {
                server.use(
                    rest.get('*', (req, res, ctx) => {
                        return res(ctx.status(500))
                    })
                )

                const { result } = renderHook(() => useRepoData(), {
                    wrapper: createWrapper()
                })

                await waitFor(() => expect(result.current.isError).toBe(true))

                expect(result.current.error).toBeDefined()
            })
        })
        ```
  ````

# í™”ë©´ ë‹¨ìœ„ ìœ ë‹›í…ŒìŠ¤íŠ¸

<p style="font-size: 25px; font-weight: bold;">íŒ¨í‚¤ì§€</p>

- jest
- react-test-renderer
- @testing-library/react
<p style="font-size: 25px; font-weight: bold;">DOM Testing</p>

- ì¸í„°ë ‰ì…˜(ì´ë²¤íŠ¸) ë‹¨ìœ„ì˜ í™”ë©´ í…ŒìŠ¤íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•œë‹¤.
- package: @testing-library/react
- Query

  - Find Text Testing
    ByText
    - getByText, queryByText, getAllByText, queryAllByText, findByText, findAllByText
      findByText
    ```tsx
    expect(await screen.findByText("name is 'gildong'")).toBeInTheDocument();
    ```
    getByText
    ```tsx
    expect(screen.getByText('1000ì›')).toBeInTheDocument(); // ë°°ì†¡ë¹„ ìˆìŒ
    ```
    queryByText
    - queryByTextëŠ” ê²€ìƒ‰í•˜ê³ ì í•˜ëŠ” í…ìŠ¤íŠ¸ê°€ ì—†ëŠ”ê²½ìš°ì— ëŒ€í•´ì„œë„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥(ë‹¤ë¥¸ apiì—ì„œëŠ” í…ìŠ¤íŠ¸ê°€ ì—†ëŠ”ê²½ìš° ì—ëŸ¬ë¥¼ ë…¸ì¶œ)
    ```tsx
    expect(screen.queryByText('AAA')).not.toBeInTheDocument();
    ```
  - Find Element Testing
    ByRole

    - getByRole, queryByRole, getAllByRole, queryAllByRole, findByRole, findAllByRole
    - ì—­í• ì„ ê°€ì§„ ìš”ì†Œë¥¼ domì—ì„œ ì–»ì–´ì˜¬ ê²½ìš° ì‚¬ìš©

    ```tsx
    // button
    const button = screen.getByRole('button');
    const buttons = screen.getAllByRole('button');

    // image
    const image = screen.getByRole('img');

    // input
    expect(screen.getByRole('textbox')).toHaveValue('2');

    // ol,li
    const list = screen.getByRole('list');
    const { getAllByRole } = within(list);
    const items = getAllByRole('listitem');

    // checkbox
    const checkbox = screen.getByRole('checkbox');
    ```

    ByLabelText

    - label, aria-label/aria-labelledby í…ìŠ¤íŠ¸ì™€ ë§¤ì¹­ë˜ëŠ” ìš”ì†Œë¥¼ ê²€ìƒ‰í•  ê²½ìš° ì‚¬ìš©

    ```tsx
    const button = screen.getByLabelText('ë²„íŠ¼');
    ```

    ByTestId

    - getByTestId, queryByTestId, getAllByTestId, queryAllByTestId, findByTestId, findAllByTestId
    - data-testid ì†ì„±ê°’ê³¼ ë§¤ì¹­ë˜ëŠ” ìš”ì†Œë¥¼ ê²€ìƒ‰í•  ê²½ìš° ì‚¬ìš©

    ```tsx
    const element = screen.getByTestId('ë²„íŠ¼í…ŒìŠ¤íŠ¸');
    ```

- Element Event

  - Element Event Testing
    click

    ```jsx
    const handleClick = jest.fn();

    beforeEach(() => {
      handleClick.mockClear();
    });

    const button = screen.getByLabelText('ì‚­ì œ ë²„íŠ¼');
    // When
    userEvent.click(button);
    // Then
    expect(handleClick).toBeCalled(); // ì‚­ì œ ë²„íŠ¼
    ```

    focus/blur

    ```jsx
    // Act
    act(() => element.focus());
    expect(element).toHaveFocus();

    // tab out(activeElementë¥¼ ë³€ê²½)
    userEvent.tab();

    // Shoud have triggered onBlur
    expect(handleChangeQuantity).toBeCalledTimes(3);
    ```

    hover

    ```jsx
    // When
    userEvent.hover(screen.getByRole('button'));

    // Then
    expect(screen.getByText('íˆ´íŒ ì…ë‹ˆë‹¤.')).toBeVisible();
    ```

    input change

    ```jsx
    // when
    userEvent.type(inputs[0], 'TEST');

    // Shoud have triggered onChange(ê¸€ìì…ë ¥ì´ ë  ë•Œë§ˆë‹¤ í˜¸ì¶œë¨)
    expect(handleChange).toBeCalledTimes(4);
    ```

    checkbox check

    ```jsx
    // When
    const checkbox = screen.getByRole('checkbox');

    userEvent.click(checkbox);

    // Then
    expect(handleCheck).toBeCalled();
    ```

    radio check

    ```jsx
    // When
    userEvent.click(screen.getByText('ë¼ë””ì˜¤ 1'));

    // Then
    expect(handleChange).toBeCalled();
    ```

- Element Event Testing

  ```tsx
  // Input Element Testing
  import React, { useState } from 'react';
  import { render, fireEvent } from '@testing-library/react';

  function CostInput() {
    const [value, setValue] = useState('');

    removeDollarSign = value => (value[0] === '$' ? value.slice(1) : value);
    getReturnValue = value => (value === '' ? '' : `$${value}`);

    handleChange = ev => {
      ev.preventDefault();
      const inputtedValue = ev.currentTarget.value;
      const noDollarSign = removeDollarSign(inputtedValue);
      if (isNaN(noDollarSign)) return;
      setValue(getReturnValue(noDollarSign));
    };

    return (
      <input value={value} aria-label="cost-input" onChange={handleChange} />
    );
  }

  const setup = () => {
    const utils = render(<CostInput />);
    const input = utils.getByLabelText('cost-input');
    return {
      input,
      ...utils,
    };
  };

  test('It should keep a $ in front of the input', () => {
    const { input } = setup();
    fireEvent.change(input, { target: { value: '23' } });
    expect(input.value).toBe('$23');
  });
  test('It should allow a $ to be in the input when the value is changed', () => {
    const { input } = setup();
    fireEvent.change(input, { target: { value: '$23.0' } });
    expect(input.value).toBe('$23.0');
  });

  test('It should not allow letters to be inputted', () => {
    const { input } = setup();
    expect(input.value).toBe(''); // empty before
    fireEvent.change(input, { target: { value: 'Good Day' } });
    expect(input.value).toBe(''); //empty after
  });

  test('It should allow the $ to be deleted', () => {
    const { input } = setup();
    fireEvent.change(input, { target: { value: '23' } });
    expect(input.value).toBe('$23'); // need to make a change so React registers "" as a change
    fireEvent.change(input, { target: { value: '' } });
    expect(input.value).toBe('');
  });
  ```

- Update Props Testing

  ```tsx
  import React, { useRef } from 'react';
  import { render, screen } from '@testing-library/react';

  let idCounter = 1;

  const NumberDisplay = ({ number }) => {
    const id = useRef(idCounter++); // to ensure we don't remount a different instance

    return (
      <div>
        <span data-testid="number-display">{number}</span>
        <span data-testid="instance-id">{id.current}</span>
      </div>
    );
  };

  test('calling render with the same component on the same container does not remount', () => {
    const { rerender } = render(<NumberDisplay number={1} />);
    expect(screen.getByTestId('number-display')).toHaveTextContent('1');

    // re-render the same component with different props
    rerender(<NumberDisplay number={2} />);
    expect(screen.getByTestId('number-display')).toHaveTextContent('2');

    expect(screen.getByTestId('instance-id')).toHaveTextContent('1');
  });
  ```

- Modals Open/Close Testing

  ```tsx
  import React, { useEffect } from 'react';
  import ReactDOM from 'react-dom';
  import { render, fireEvent } from '@testing-library/react';

  const modalRoot = document.createElement('div');
  modalRoot.setAttribute('id', 'modal-root');
  document.body.appendChild(modalRoot);

  const Modal = ({ onClose, children }) => {
    const el = document.createElement('div');

    useEffect(() => {
      modalRoot.appendChild(el);

      return () => modalRoot.removeChild(el);
    });

    return ReactDOM.createPortal(
      <div onClick={onClose}>
        <div onClick={e => e.stopPropagation()}>
          {children}
          <hr />
          <button onClick={onClose}>Close</button>
        </div>
      </div>,
      el,
    );
  };

  test('modal shows the children and a close button', () => {
    // Arrange
    const handleClose = jest.fn();

    // Act
    const { getByText } = render(
      <Modal onClose={handleClose}>
        <div>test</div>
      </Modal>,
    );
    // Assert
    expect(getByText('test')).toBeTruthy();

    // Act
    fireEvent.click(getByText(/close/i));

    // Assert
    expect(handleClose).toHaveBeenCalledTimes(1);
  });
  ```

<p style="font-size: 25px; font-weight: bold;">Snapshot Testing</p>
- package: react-test-renderer

```tsx
// Link.js
import { useState } from 'react';

const STATUS = {
  HOVERED: 'hovered',
  NORMAL: 'normal',
};

export default function Link({ page, children }) {
  const [status, setStatus] = useState(STATUS.NORMAL);

  const onMouseEnter = () => {
    setStatus(STATUS.HOVERED);
  };

  const onMouseLeave = () => {
    setStatus(STATUS.NORMAL);
  };

  return (
    <a
      className={status}
      href={page || '#'}
      onMouseEnter={onMouseEnter}
      onMouseLeave={onMouseLeave}
    >
      {children}
    </a>
  );
}

// Link.test.js
import renderer from 'react-test-renderer';
import Link from '../Link';

it('changes the class when hovered', () => {
  const component = renderer.create(
    <Link page="http://www.facebook.com">Facebook</Link>,
  );
  let tree = component.toJSON();
  expect(tree).toMatchSnapshot();

  // manually trigger the callback
  renderer.act(() => {
    tree.props.onMouseEnter();
  });
  // re-rendering
  tree = component.toJSON();
  expect(tree).toMatchSnapshot();

  // manually trigger the callback
  renderer.act(() => {
    tree.props.onMouseLeave();
  });
  // re-rendering
  tree = component.toJSON();
  expect(tree).toMatchSnapshot();
});
```

# React ìœ ë‹›í…ŒìŠ¤íŠ¸

<p style="font-size: 25px; font-weight: bold;">íŒ¨í‚¤ì§€</p>

- jest
- @testing-library/react(v13.1.0 ì´ìƒ)
- @testing-library/react-hooks
<p style="font-size: 25px; font-weight: bold;">Custom Hook Testing</p>

```tsx
// @testing-library/react-hooks
import { renderHook } from '@testing-library/react-hooks';

// @testing-library/react v13.1.0 ì´ìƒ
import { renderHook } from '@testing-library/react';

export function useCustomHook() {
  return 'Hello';
}

const { result } = renderHook(() => useCustomHook());

expect(result.current).toEqual('Hello');
```

<p style="font-size: 25px; font-weight: bold;">ContextAPI Testing</p>

```tsx
import React from 'react';

const NameContext = React.createContext('Unknown');

const NameProvider = ({ children, first, last }) => {
  const fullName = `${first} ${last}`;
  return (
    <NameContext.Provider value={fullName}>{children}</NameContext.Provider>
  );
};

const NameConsumer = () => (
  <NameContext.Consumer>
    {value => <div>My Name Is: {value}</div>}
  </NameContext.Consumer>
);

export { NameContext, NameConsumer, NameProvider };

/**
 * Test default values by rendering a context consumer without a
 * matching provider
 */
test('NameConsumer shows default value', () => {
  render(<NameConsumer />);
  expect(screen.getByText(/^My Name Is:/)).toHaveTextContent(
    'My Name Is: Unknown',
  );
});

/**
 * To test a component tree that uses a context consumer but not the provider,
 * wrap the tree with a matching provider
 */
test('NameConsumer shows value from provider', () => {
  render(
    <NameContext.Provider value="C3P0">
      <NameConsumer />
    </NameContext.Provider>,
  );
  expect(screen.getByText(/^My Name Is:/)).toHaveTextContent(
    'My Name Is: C3P0',
  );
});

/**
 * To test a component that provides a context value, render a matching
 * consumer as the child
 */
test('NameProvider composes full name from first, last', () => {
  render(
    <NameProvider first="Boba" last="Fett">
      <NameContext.Consumer>
        {value => <span>Received: {value}</span>}
      </NameContext.Consumer>
    </NameProvider>,
  );
  expect(screen.getByText(/^Received:/).textContent).toBe(
    'Received: Boba Fett',
  );
});

/**
 * A tree containing both a providers and consumer can be rendered normally
 */
test('NameProvider/Consumer shows name of character', () => {
  render(
    <NameProvider first="Leia" last="Organa">
      <NameConsumer />
    </NameProvider>,
  );
  expect(screen.getByText(/^My Name Is:/).textContent).toBe(
    'My Name Is: Leia Organa',
  );
});
```

<p style="font-size: 25px; font-weight: bold;">React-Router Testing</p>

````tsx
import {render as rtlRender, screen} from '@testing-library/react'
import userEvent from '@testing-library/user-event'
import \* as React from 'react'
import {
Link,
Route,
BrowserRouter as Router,
Switch,
useLocation,
} from 'react-router-dom'

    const About = () => <div>You are on the about page</div>
    const Home = () => <div>You are home</div>
    const NoMatch = () => <div>No match</div>

    const LocationDisplay = () => {
      const location = useLocation()

      return <div data-testid="location-display">{location.pathname}</div>
    }

    const App = () => (
      <div>
        <Link to="/">Home</Link>

        <Link to="/about">About</Link>

        <Switch>
          <Route exact path="/">
            <Home />
          </Route>

          <Route path="/about">
            <About />
          </Route>

          <Route>
            <NoMatch />
          </Route>
        </Switch>

        <LocationDisplay />
      </div>
    )

    // Ok, so here's what your tests might look like

    // this is a handy function that I would utilize for any component
    // that relies on the router being in context
    const render = (ui, {route = '/'} = {}) => {
      window.history.pushState({}, 'Test page', route)

      return rtlRender(ui, {wrapper: Router})
    }

    test('full app rendering/navigating', () => {
      render(<App />)
      expect(screen.getByText(/you are home/i)).toBeInTheDocument()

      userEvent.click(screen.getByText(/about/i))

      expect(screen.getByText(/you are on the about page/i)).toBeInTheDocument()
    })

    test('landing on a bad page', () => {
      render(<App />, {route: '/something-that-does-not-match'})

      expect(screen.getByText(/no match/i)).toBeInTheDocument()
    })

    test('rendering a component that uses useLocation', () => {
      const route = '/some-route'
      render(<LocationDisplay />, {route})

      // avoid using test IDs when you can
      expect(screen.getByTestId('location-display')).toHaveTextContent(route)
    })
    ```
````

# ì°¸ê³ í˜ì´ì§€

- [https://jestjs.io/docs/expect](https://jestjs.io/docs/expect)
- [https://runebook.dev/ko/docs/jest/expect](https://runebook.dev/ko/docs/jest/expect)
- [https://www.js2uix.com/frontend/jest-study-step3/](https://www.js2uix.com/frontend/jest-study-step3/)
- [https://www.npmjs.com/package/jest-dom/v/3.4.0#toberequired](https://www.npmjs.com/package/jest-dom/v/3.4.0#toberequired)
- [https://yunsuu.github.io/%EA%B0%9C%EC%9D%B8%EA%B3%B5%EB%B6%80/common-mistake-testing-library-post/](https://yunsuu.github.io/%EA%B0%9C%EC%9D%B8%EA%B3%B5%EB%B6%80/common-mistake-testing-library-post/)
- [https://seongry.github.io/2021/06-20-common-mistakes-with-rty/](https://seongry.github.io/2021/06-20-common-mistakes-with-rty/)
- [https://testing-library.com/docs/ecosystem-user-event](https://testing-library.com/docs/ecosystem-user-event)
- [https://tanstack.com/query/v4/docs/guides/testing?from=reactQueryV3&original=https://react-query-v3.tanstack.com/guides/testing](https://tanstack.com/query/v4/docs/guides/testing?from=reactQueryV3&original=https://react-query-v3.tanstack.com/guides/testing)
- [https://tkdodo.eu/blog/testing-react-query](https://tkdodo.eu/blog/testing-react-query)
- [https://jestjs.io/docs/tutorial-react](https://jestjs.io/docs/tutorial-react)
- [https://github.com/facebook/jest](https://github.com/facebook/jest)
- [https://github.com/facebook/jest/tree/main/examples/snapshot/**tests**](https://github.com/facebook/jest/tree/main/examples/snapshot/__tests__)
- [https://github.com/facebook/jest/tree/main/examples/react-testing-library](https://github.com/facebook/jest/tree/main/examples/react-testing-library)
- [https://github.com/facebook/jest/tree/main/examples/react](https://github.com/facebook/jest/tree/main/examples/react)
- [https://testing-library.com/docs/example-input-event](https://testing-library.com/docs/example-input-event)
- [https://codesandbox.io/s/github/kentcdodds/react-testing-library-examples/tree/main/?file=/src/**tests**/on-change.js:464-471](https://codesandbox.io/s/github/kentcdodds/react-testing-library-examples/tree/main/?file=/src/__tests__/on-change.js:464-471)
